<html>
    <head>
        <title>Fallout 76 Weapon damage calculator</title>
        <style>
            * {
                font-family: sans-serif;
                font-size: 20px;
            }
            td {
                padding: 1px;
            }
            
            table.infoTable {
               border: 1px solid black;
               border-collapse: collapse;
            }
            table.infoTable td {
               border: 1px solid black;
            }
        </style>
        <meta name="keywords" content="Fallout,Fallout 76,Weapons,Damage,Calculation,Comparison,Comparator">
    </head>
    <body style="height: 90%">
        <center>
            <span style="font-size: 36px; font-weight: bold;">Fallout 76 Weapon Damage Calculator (v2.0.17)</span><br/>
            <!-- <sup style='font-size: 16px;'>* Only ballistic damage; energy damage and resistances are not fully explored yet.</sup> -->
        <br/>
        <table id="parent">
            <tr>
                <td style='vertical-align: top;'>
                        <table id="table1" style="border: 1px solid black;">
                                <tr>
                                    <td>Weapon type</td>
                                    <td>
                                        <input type="radio" id="wtMelee1" name="weaponType1" value="Melee"/><span id="spMelee1" style="cursor: pointer;"> Melee</span>
                                        &nbsp;&nbsp;&nbsp;&nbsp;
                                        <input type="radio" id="wtRanged1" name="weaponType1" value="Ranged"/><span id="spRanged1" style="cursor: pointer;"> Ranged</span>
                                    </td>
                                </tr>
                
                            </table>            
                </td>
                <td style="padding-left: 20px; padding-right:20px; text-align: center; vertical-align: top; width: 100px;">
                    <button id="copyright" title="Copy Right">&gt;&gt;</button>
                    <br/>
                    <button id="copyleft" title="Copy left">&lt;&lt;</button>
                </td>
                <td style='vertical-align: top;'>
                    <table id="table2" style="border: 1px solid black;">
                        <tr>
                            <td>Weapon type</td>
                            <td>
                                <input type="radio" id="wtMelee2" name="weaponType2" value="Melee"/><span id="spMelee2" style="cursor: pointer;"> Melee</span>
                                &nbsp;&nbsp;&nbsp;&nbsp;
                                <input type="radio" id="wtRanged2" name="weaponType2" value="Ranged"/><span id="spRanged2" style="cursor: pointer;"> Ranged</span>
                            </td>
                        </tr>
        
                    </table>            
                </td>
            </tr>
            <tr>
                <td colspan="3" align='center'>
                    <br/>
                    <h2>Comparison</h2>
                    <div>
                        <input type='radio' name='comparemode' id='damagemode' checked='checked'/><span id='spdamagemode' style='cursor: pointer;'> Single hit damage</span>&nbsp;&nbsp;&nbsp;&nbsp;
                        <input type='radio' name='comparemode' id='dpsmode'/><span id='spdpsmode' style='cursor: pointer;'> Damage per second</span>
                    </div>
                    <br/>
                    
                    <table id="table3" style="border: 1px solid black; border-collapse: collapse;">
                        <tr>
                            <td colspan='3' style="border: 1px solid black;">Enemy</td>
                            <td colspan="4" style="border: 1px solid black;">Left weapon</td>
                            <td colspan="4" style="border: 1px solid black;">Right weapon</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid black;">DR</td>
                            <td style="border: 1px solid black;">ER</td>
                            <td style="border: 1px solid black;">RR</td>
                            <td style="border: 1px solid black;" id='ActualDRLeft'>Actual DR</td>
                            <td style="border: 1px solid black;" id='ActualERLeft'>Actual ER</td>
                            <td style="border: 1px solid black;">Damage dealt</td>
                            <td style="border: 1px solid black;">Compare Right</td>
                            <td style="border: 1px solid black;" id='ActualDRRight'>Actual DR</td>
                            <td style="border: 1px solid black;" id='ActualERRight'>Actual ER</td>
                            <td style="border: 1px solid black;">Damage dealt</td>
                            <td style="border: 1px solid black;">Compare Left</td>
                        </tr>
                    </table> 
                </td>
            </tr>
        </table>
        </center>
        <script>
            var allWeapons = new Map();
            var allEffects = new Map();
            var enemyCategories = [];

            var damages = [0, 0, 0];
            var damagesEnergy = [0, 0, 0];
            var damagesRadiation = [0, 0, 0];
            var ignores = [0, 0, 0];
            var speeds = [1, 1, 1];

            // -------------------------------------------------------------------------------
            // Setup weapon data
            // -------------------------------------------------------------------------------

            var speedSlow = 0.55;
            var speedMedium = 0.88;
            var speedFast = 1.26;
            var speedVFast = 4.2;
            
            allWeapons.set("Melee", [
                {
                    name: "Board",
                    category: "One-handed",
                    strengthFactor: 0.1,
                    speed: speedSlow,
                    level: [1, 5, 15, 25, 35, 45],
                    damage: [14, 18, 22, 26, 30, 33],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Spiked",
                                    damageMultPercent: 15,
                                    ignoreDRPercent: 10
                                },
                                {
                                    name: "Puncturing",
                                    damageMultPercent: 20,
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Bladed",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Deathclaw Gauntlet",
                    category: "Unarmed",
                    speed: speedMedium,
                    level: [30, 40, 50],
                    damage: [45, 50, 55],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Extra claw",
                                    damageMultPercent: 20,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Super Sledge",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [30, 40, 50],
                    damage: [65, 75, 85],
                    mods: [
                    {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Heating coil",
                                    addDamageEnergyLeveled: [5, 7.5, 10]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Tenderizer",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [10, 20, 30, 40, 50],
                    damage: [35, 45, 55, 67, 75],
                    mods: [
                    
                    ]
                },
                {
                    name: "Power Fist",
                    category: "Unarmed",
                    speed: speedMedium,
                    level: [30, 40, 50],
                    damage: [48, 53, 58],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Puncturing",
                                    ignoreDRPercent: 20,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Mole Miner Gauntlet",
                    category: "Unarmed",
                    strengthFactor: 0.1,
                    speed: speedMedium,
                    level: [20, 30, 40, 50],
                    damage: [30, 35, 40, 45],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Third Blade",
                                    damageMultPercent: 15,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Death Tambo",
                    category: "Unarmed",
                    speed: speedMedium,
                    level: [15, 25, 35, 45],
                    damage: [30, 35, 40, 45],
                    mods: []
                },
                {
                    name: "Machete",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [15, 17, 20, 25, 30, 35, 40],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Serrated",
                                    damageMultPercent: 20,
                                },
                                {
                                    name: "Sacrificial",
                                    damageMultPercent: 15,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Bowie Knife",
                    category: "One-handed",
                    speed: speedFast,
                    level: [10, 15, 25, 35, 45],
                    damage: [10, 15, 20, 25, 30],
                    mods: []
                },
                {
                    name: "Boxing Glove",
                    category: "Unarmed",
                    speed: speedMedium,
                    level: [5, 15, 25, 35, 45],
                    damage: [13, 18, 23, 28, 34],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Lead Lining",
                                    damageMultPercent: 20,
                                },
                                {
                                    name: "Spiked",
                                    damageMultPercent: 10,
                                },
                                {
                                    name: "Puncturing",
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Cultist Blade",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [10, 20, 30, 40, 50],
                    damage: [15, 20, 25, 30, 35],
                    mods: []
                },
                {
                    name: "Cultist Dagger",
                    category: "One-handed",
                    speed: speedFast,
                    level: [15, 25, 35, 45],
                    damage: [20, 25, 28, 32],
                    mods: []
                },
                {
                    name: "Multi-purpose Axe",
                    category: "One-handed",
                    speed: speedSlow,
                    level: [1, 5, 15, 25, 35, 45],
                    damage: [26, 32, 42, 52, 62, 69],
                    mods: []
                },
                {
                    name: "Combat Knife",
                    category: "One-handed",
                    speed: speedFast,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [9, 13, 17, 21, 25, 29, 33],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Serrated",
                                    damageMultPercent: 10,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Hatchet",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [15, 17, 20, 25, 30, 35, 40],
                    mods: []
                },
                {
                    name: "Pickaxe",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [5, 15, 25, 35, 45],
                    damage: [32, 41, 48, 55, 60],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sharp",
                                    damageMultPercent: 15
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Ski Sword",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [15, 25, 35, 45],
                    damage: [35, 40, 45, 50],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Metal Shards",
                                    damageMultPercent: 20,
                                },
                                {
                                    name: "Skate",
                                    damageMultPercent: 10,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Rolling pin",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [9, 12, 15, 19, 22, 25, 28],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sharp",
                                    damageMultPercent: 10,
                                },
                                {
                                    name: "Spiked",
                                    damageMultPercent: 25,
                                },
                                {
                                    name: "Chef's",
                                    damageMultPercent: 20,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Knuckles",
                    category: "Unarmed",
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [8, 10, 15, 20, 25, 30, 35],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sharp",
                                    damageMultPercent: 10
                                },
                                {
                                    name: "Bladed",
                                    damageMultPercent: 10,
                                },
                                {
                                    name: "Spiked",
                                    damageMultPercent: 10,
                                },
                                {
                                    name: "Puncturing",
                                    damageMultPercent: 10,
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Lead Pipe",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [14, 16, 19, 24, 29, 34, 39],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Heavy",
                                    damageMultPercent: 10,
                                },
                                {
                                    name: "Spiked",
                                    damageMultPercent: 10,
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Tire Iron",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [12, 14, 17, 20, 23, 26, 29],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Bladed",
                                    damageMultPercent: 10,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Blade of Bastet",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [25, 35, 45],
                    damage: [42, 46, 52],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Serrated",
                                    damageMultPercent: 20,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Fire Axe",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [5, 15, 25, 35, 45],
                    damage: [35, 45, 55, 65, 72],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Spikes",
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Guitar Sword",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [15, 25, 35, 45],
                    damage: [35, 40, 45, 50],
                    mods: []
                },
                {
                    name: "Assaultron Blade",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [25, 35, 45],
                    damage: [28, 33, 40],
                    mods: []
                },
                {
                    name: "Pitchfork",
                    category: "Two-handed",
                    strengthFactor: 0.1,
                    speed: speedMedium,
                    level: [1, 5, 15, 25, 35, 45],
                    damage: [22, 27, 32, 37, 42, 47],
                    mods: [
                        {
                            slot: "Forks",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Barbed",
                                    damageMultPercent: 15
                                },
                                {
                                    name: "Flaming",
                                    damageMultPercent: 15,
                                    addDamageEnergyLeveled: [2, 3.5, 5, 6.5, 8, 9.5]
                                },
                                {
                                    name: "Barbed Flaming",
                                    damageMultPercent: 15,
                                    addDamageEnergyLeveled: [2, 3.5, 5, 6.5, 8, 9.5]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Revolutionary Sword",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [10, 20, 30, 40, 50],
                    damage: [24, 29, 34, 39, 44],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Serrated",
                                    damageMultPercent: 10
                                },
                                {
                                    name: "Electrified",
                                    addDamageEnergyPercentLeveled: [10, 15, 20, 25, 30]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "War Drum",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [15, 25, 35, 45],
                    damage: [48, 58, 68, 78],
                    mods: []
                },
                {
                    name: "Walking Cane",
                    category: "One-handed",
                    strengthFactor: 0.1,
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [17, 19, 22, 27, 32, 37, 42],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Barbed",
                                    damageMultPercent: 10,
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Spiked",
                                    damageMultPercent: 10
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Security Baton",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [5, 15, 25, 35, 45],
                    damage: [15, 25, 30, 35, 40],
                    mods: []
                },
                {
                    name: "Meat Hook",
                    category: "Unarmed",
                    speed: speedMedium,
                    level: [5, 15, 25, 35, 45],
                    damage: [14, 19, 24, 29, 34],
                    mods: [
                        {
                            slot: "Hooks",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Extra",
                                    damageMultPercent: 20,
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Pipe Wrench",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [13, 15, 18, 21, 24, 27, 30],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hooked",
                                    damageMultPercent: 10
                                },
                                {
                                    name: "Heavy",
                                    damageMultPercent: 15,
                                },
                                {
                                    name: "Extra Heavy",
                                    damageMultPercent: 25,
                                },
                                {
                                    name: "Puncturing",
                                    damageMultPercent: 10,
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Ripper",
                    category: "One-handed",
                    speed: speedVFast,
                    level: [40],
                    damage: [3],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Extended",
                                    damageMultPercent: 66.6,
                                },
                                {
                                    name: "Curved",
                                    damageMultPercent: 33.3,
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Mr. Handy Buzz Blade",
                    category: "One-handed",
                    speed: speedVFast,
                    level: [15, 25, 35, 45],
                    damage: [4, 5, 6, 7],
                    mods: [ {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Electrified",
                                    addDamageEnergyPercentLeveled: [10, 15, 20, 25]
                                }
                            ]
                        }]
                },
                {
                    name: "Chinese Officer Sword",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [5, 15, 25, 35, 45],
                    damage: [16, 21, 26, 31, 36],
                    mods: [
                        {
                            slot: "Blade",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Serrated",
                                    damageMultPercent: 10,
                                },
                                {
                                    name: "Electrified",
                                    addDamageEnergyPercentLeveled: [5, 10, 15, 20, 25]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Grognak's Axe",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [30, 40, 50],
                    damage: [65, 75, 85],
                    mods: []
                },
                {
                    name: "Shishkebab",
                    category: "One-handed",
                    speed: speedMedium,
                    level: [35, 45],
                    damage: [22, 27],
                    damageEnergy: [22, 27],
                    mods: [
                    {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Extra Flame Jets",
                                    addDamageEnergyLeveled: [8, 9.5]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Sledgehammer",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [10, 20, 30, 40, 50],
                    damage: [43, 50, 57, 65, 71],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sharp",
                                    damageMultPercent: 15,
                                },
                                {
                                    name: "Heavy",
                                    damageMultPercent: 20,
                                    ignoreDRPercent: 15
                                },
                                {
                                    name: "Heavy Rocket",
                                    damageMultPercent: 25,
                                },
                                {
                                    name: "Heavy Spiked",
                                    damageMultPercent: 25,
                                    ignoreDRPercent: 15
                                },
                                {
                                    name: "Heavy Sharp",
                                    damageMultPercent: 25,
                                },
                                {
                                    name: "Heavy Shearing Sharp Rocket",
                                    damageMultPercent: 15,
                                    addDamageEnergyLeveled: [3, 4.5, 7, 8.5, 10]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Baseball Bat",
                    category: "Two-handed",
                    strengthFactor: 0.1,
                    speed: speedSlow,
                    level: [1, 5, 15, 25, 35, 45],
                    damage: [28, 35, 40, 45, 50, 55],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Barbed Wire",
                                    damageMultPercent: 20,
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Nails",
                                    damageMultPercent: 25,
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Razors",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Chains",
                                    damageMultPercent: 50
                                },
                                {
                                    name: "Saw Blades",
                                    damageMultPercent: 75
                                },
                                {
                                    name: "Bladed Rocket",
                                    damageMultPercent: 75
                                },
                                {
                                    name: "Heated Rocket",
                                    damageMultPercent: 20
                                },
                                {
                                    name: "Spiked Rocket",
                                    damageMultPercent: 25,
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Puncturing Rocket",
                                    damageMultPercent: 25,
                                    ignoreDRPercent: 20
                                }
                            ]
                        },
                        {
                            slot: "Material",
                            options: [
                                {
                                    name: "Wood"
                                },
                                {
                                    name: "All Star",
                                    damageMultPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Drill",
                    category: "One-handed",
                    strengthFactor: 0.1,
                    speed: speedVFast,
                    level: [20],
                    damage: [14],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Piercing",
                                    damageMultPercent: 15,
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Spear",
                    category: "One-handed",
                    strengthFactor: 0.1,
                    speed: 0.62,
                    level: [15, 25, 35, 45],
                    damage: [43, 48, 53, 58],
                    mods: [
                    ]
                },
                {
                    name: "Pole Hook",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [10, 20, 30, 40, 50],
                    damage: [43, 50, 57, 65, 71],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Multihook",
                                    damageMultPercent: 50,
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Sheperd's Crook",
                    category: "Two-handed",
                    speed: speedSlow,
                    level: [10, 20, 30, 40, 50],
                    damage: [10, 20, 30, 40, 50],
                    mods: [
                        {
                            slot: "Main",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Spiked",
                                    damageMultPercent: 10,
                                    ignoreDRPercent: 20
                                }
                            ]
                        }
                    ]
                },
            ]);

            // xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

            // the default magazine selection for typical weapons
            var standardAPMagazines = {
                            slot: "Magazine",
                            options: [
                                {
                                    name: "Standard",
                                    ignoreDRPercent: 0
                                },
                                {
                                    name: "Stinging",
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Piercing",
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Perforating",
                                    ignoreDRPercent: 40
                                }                            
                            ]
                        }
            
            var standardMuzzle = {
                slot: "Muzzle",
                options: [
                    {
                        name: "Standard",
                    },
                    {
                        name: "Suppressor",
                        silencer: true
                    }
                ]  
            };

            allWeapons.set("Ranged", [
                {
                    name: "Handmade",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 4,
                    level: [15, 25, 35, 45],
                    damage: [30, 35, 40, 45],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: 87.5,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        standardAPMagazines,
                        standardMuzzle
                    ]
                },
                {
                    name: "Hunting Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 0.3,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [40, 45, 50, 55, 60, 65, 70],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: ".38",
                                    damageMultPercent: -25
                                },
                                {
                                    name: ".50",
                                    damageMultPercent: 33.3
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 40,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        standardAPMagazines,
                        standardMuzzle
                    ]
                },
                {
                    name: "Lever Action Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 0.5,
                    level: [25, 35, 45],
                    damage: [65, 70, 75],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        standardMuzzle
                    ]
                },
                {
                    name: "Black Powder Rifle",
                    category: "Rifle",
                    explosive: false,
                    speed: 0.1,
                    level: [15, 25, 35, 45],
                    damage: [150, 160, 170, 180],
                    mods: [ ]
                },
                {
                    name: "The Dragon",
                    category: "Rifle",
                    explosive: false,
                    speed: 0.1,
                    level: [35, 45],
                    damage: [200, 225],
                    mods: [ ]
                },
                {
                    name: "Assault Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 4,
                    level: [30, 40, 50],
                    damage: [25, 29, 33],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: 87.5,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardAPMagazines,
                        standardMuzzle
                    ]
                },
                {
                    name: "Gatling Gun",
                    category: "Heavy",
                    explosive: false,
                    speed: 2,
                    level: [20, 30, 40, 50],
                    damage: [43, 57, 72, 86],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Speedy",
                                    speedMultPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Railway Rifle",
                    category: "Rifle",
                    explosive: false,
                    speed: 1,
                    level: [30, 40, 50],
                    damage: [75, 85, 95],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: 650
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "50 Cal Machine Gun",
                    category: "Heavy",
                    explosive: false,
                    speed: 9.1,
                    level: [25, 35, 45],
                    damage: [29, 36, 43],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard",
                                    ignoreDRPercent: 0
                                },
                                {
                                    name: "Heavy",
                                    damageMultPercent: 15,
                                }                           
                            ]
                        }
                    ]
                },
                {
                    name: "Light Machine Gun",
                    category: "Heavy",
                    explosive: false,
                    speed: 15.9,
                    level: [30, 40, 50],
                    damage: [29, 34, 42],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 10,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Minigun",
                    category: "Heavy",
                    explosive: false,
                    speed: 18.2,
                    level: [35, 45],
                    damage: [20, 24],
                    mods: [
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Accelerated",
                                    damageMultPercent: 10,
                                    speedMultPercent: 25
                                },
                                {
                                    name: "Tri",
                                    damageMultPercent: 20,
                                    speedMultPercent: -25
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 15,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Combat Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 3.3,
                    level: [20, 30, 40, 50],
                    damage: [28, 32, 36, 40],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "Hair Triggered",
                                    speedMultPercent: speedMult(5, 3.3),
                                },
                                {
                                    name: "Focused",
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "Hasty .38",
                                    damageMultPercent: -25,
                                    speedMultPercent: speedMult(4, 3.3),
                                },
                                {
                                    name: "Refined .38",
                                    damageMultPercent: -8.75,
                                },
                                {
                                    name: "Severe",
                                    damageMultPercent: 8.75,
                                },
                                {
                                    name: "Steadfast",
                                    speedMultPercent: speedMult(4, 3.3),
                                },
                                {
                                    name: "Tweaked Automatic",
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "True"
                                },
                                {
                                   name: "Vicious"
                                },
                                {
                                   name: "Vigorous",
                                   speedMultPercent: speedMult(4, 3.3),
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: speedMult(7.5, 3.3),
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardAPMagazines,
                        standardMuzzle
                    ]
                },
                {
                    name: "The Fixer",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 3.3,
                    level: [20, 30, 40, 50],
                    damage: [33, 38, 43, 48],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "Hair Triggered",
                                    speedMultPercent: speedMult(5, 3.3),
                                },
                                {
                                    name: "Focused",
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "Hasty .38",
                                    damageMultPercent: -25,
                                    speedMultPercent: speedMult(4, 3.3),
                                },
                                {
                                    name: "Refined .38",
                                    damageMultPercent: -8.75,
                                },
                                {
                                    name: "Severe",
                                    damageMultPercent: 8.75,
                                },
                                {
                                    name: "Steadfast",
                                    speedMultPercent: speedMult(4, 3.3),
                                },
                                {
                                    name: "Tweaked Automatic",
                                    speedMultPercent: speedMult(7.5, 3.3),
                                },
                                {
                                    name: "True"
                                },
                                {
                                   name: "Vicious"
                                },
                                {
                                   name: "Calibrated",
                                   preinstalled: true
                                },
                                {
                                   name: "Vigorous",
                                   speedMultPercent: speedMult(4, 3.3),
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: speedMult(7.5, 3.3),
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        {
                            slot: "Magazine",
                            options: [
                                {
                                    name: "Standard",
                                    ignoreDRPercent: 0
                                },
                                {
                                    name: "Stinging",
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Piercing",
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Perforating",
                                    ignoreDRPercent: 40,
                                    preinstalled: true
                                }                            
                            ]
                        },
                        {
                            slot: "Muzzle",
                            options: [
                                {
                                    name: "Standard",
                                },
                                {
                                    name: "Suppressor",
                                    silencer: true,
                                    preinstalled: true
                                }
                            ]  
                        }
                    ]
                },
                {
                    name: "Combat Shotgun",
                    category: "Shotgun",
                    explosive: false,
                    silencer: true,
                    speed: 2,
                    level: [20, 30, 40, 50],
                    damage: [60, 70, 80, 90],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: 87.5,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardAPMagazines,
                        standardMuzzle
                    ]
                },
                {
                    name: "Pump Action Shotgun",
                    category: "Shotgun",
                    explosive: false,
                    silencer: true,
                    speed: 3.6,
                    level: [5, 15, 25, 35, 45],
                    damage: [55, 65, 75, 85, 95],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardMuzzle
                    ]
                },
                {
                    name: "Double-barrel Shotgun",
                    category: "Shotgun",
                    explosive: false,
                    speed: 3.6,
                    level: [15, 25, 35, 45],
                    damage: [80, 90, 100, 115],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Powerful",
                                    damageMultPercent: 15
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Crossbow",
                    category: "Rifle",
                    explosive: false,
                    speed: 0.4,
                    level: [15, 25, 35, 45],
                    damage: [55, 60, 65, 70],
                    mods: [
                        {
                            slot: "Frame",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 15,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "10mm Pistol",
                    category: "Pistol",
                    explosive: false,
                    silencer: true,
                    speed: 4.3,
                    level: [5, 15, 25, 35, 45],
                    damage: [15, 18, 21, 24, 28],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: 87.5
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: 87.5,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardAPMagazines,
                        standardMuzzle
                    ]
                },
                {
                    name: "Western Revolver",
                    category: "Pistol",
                    explosive: false,
                    speed: 0.6,
                    level: [20, 30, 40, 50],
                    damage: [50, 55, 60, 65],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Submachine Gun",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 7.5,
                    level: [15, 25, 35, 45],
                    damage: [18, 22, 25, 29],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Armor-piercing",
                                    ignoreDRPercent: 40
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardMuzzle
                    ]
                },
                {
                    name: "10mm SMG",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 9.1,
                    level: [10, 20, 30, 40, 50],
                    damage: [17, 19, 23, 28, 34],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        {
                            slot: "Magazine",
                            options: [
                                {
                                    name: "Standard",
                                    ignoreDRPercent: 0
                                },
                                {
                                    name: "Piercing",
                                    ignoreDRPercent: 20
                                },
                            ]
                        },
                        standardMuzzle
                    ]
                },
                {
                    name: "Broadsider",
                    category: "Heavy",
                    explosive: true,
                    speed: 0.3,
                    level: [25, 35, 45],
                    damage: [95, 115, 135],
                    mods: []
                },
                {
                    name: "Harpoon Gun",
                    category: "Heavy",
                    explosive: false,
                    speed: 0.2,
                    level: [30, 40, 50],
                    damage: [125, 150, 175],
                    mods: [
                    {
                            slot: "Ammunition",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Flechette",
                                    damageMultPercent: 100
                                }
                            ]
                        }
                    ]
                },
                {
                    name: ".44 Pistol",
                    category: "Pistol",
                    explosive: false,
                    speed: 0.6,
                    level: [5, 15, 25, 35, 45],
                    damage: [40, 45, 50, 55, 60],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Black Powder Pistol",
                    category: "Pistol",
                    explosive: false,
                    speed: 0.2,
                    level: [10, 20, 30, 40, 50],
                    damage: [115, 130, 145, 160, 175],
                    mods: []
                },
                {
                    name: "Black Powder Blunderbuss",
                    category: "Pistol",
                    explosive: false,
                    speeD: 0.2,
                    level: [10, 20, 30, 40, 50],
                    damage: [115, 130, 145, 160, 175],
                    mods: []
                },
                {
                    name: "Pipe Bolt-action Pistol",
                    category: "Pistol",
                    explosive: false,
                    speed: 0.3,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [40, 45, 50, 55, 60, 65, 70],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Pipe Bolt-action Rifle",
                    category: "Rifle",
                    explosive: false,
                    speed: 0.3,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [40, 45, 50, 55, 60, 65, 70],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Pipe Pistol",
                    category: "Pistol",
                    explosive: false,
                    speed: 6,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [12, 13, 15, 18, 21, 23, 26],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: 50
                                },
                                {
                                    name: "Scorch killer's",
                                    damageMultPercent: -20,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusAddPercent: 50
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: 50,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardAPMagazines
                    ]
                },
                {
                    name: "Pipe Revolver Pistol",
                    category: "Pistol",
                    explosive: false,
                    speed: 0.5,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [27, 31, 36, 40, 45, 50, 55],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Pipe Revolver Rifle",
                    category: "Rifle",
                    explosive: false,
                    speed: 0.4,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [27, 31, 36, 40, 45, 50, 55],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Pipe Rifle",
                    category: "Rifle",
                    explosive: false,
                    speed: 6,
                    level: [1, 5, 10, 20, 30, 40, 50],
                    damage: [12, 13, 15, 18, 21, 23, 26],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -10,
                                    speedMultPercent: 50
                                },
                                {
                                    name: "Powerful Automatic",
                                    damageMultPercent: 11.11,
                                    speedMultPercent: 50
                                },
                                {
                                    name: "Prime Automatic",
                                    damageMultPercent: 15,
                                    speedMultPercent: 50,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                }
                            ]
                        },
                        standardAPMagazines
                    ]
                },
                {
                    name: "Gauss Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 6.7,
                    level: [35, 45],
                    damage: [125, 140],
                    mods: [
                        {
                            slot: "Capacitors",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Stinging",
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Piercing",
                                    ignoreDRPercent: 20
                                },
                                {
                                    name: "Perforating",
                                    ignoreDRPercent: 40
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        standardMuzzle
                    ]
                },
                {
                    name: "Radium Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: true,
                    speed: 4,
                    level: [40, 50],
                    damage: [33, 37],
                    damageRadiation: [13, 15],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Hardened",
                                    damageMultPercent: 25,
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        standardAPMagazines,
                        standardMuzzle
                    ]
                },
                {
                    name: "Laser Pistol",
                    category: "Pistol",
                    explosive: false,
                    silencer: false,
                    speed: 4,
                    level: [5, 15, 25, 35, 45],
                    damage: [0, 0, 0, 0, 0],
                    damageEnergy: [21, 26, 31, 36, 44],
                    mods: [
                        {
                            slot: "Capacitor",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Laser Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: false,
                    speed: 5,
                    level: [5, 15, 25, 35, 45],
                    damage: [0, 0, 0, 0, 0],
                    damageEnergy: [21, 26, 31, 36, 44],
                    mods: [
                        {
                            slot: "Capacitor",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Ultracite Laser Pistol",
                    category: "Pistol",
                    explosive: false,
                    silencer: false,
                    speed: 4,
                    level: [30, 40, 50],
                    damage: [0, 0, 0],
                    damageEnergy: [28, 31, 34],
                    mods: [
                        {
                            slot: "Capacitor",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Ultracite Laser Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: false,
                    speed: 5,
                    level: [30, 40, 50],
                    damage: [0, 0, 0, 0, 0],
                    damageEnergy: [28, 31, 34],
                    mods: [
                        {
                            slot: "Capacitor",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        },
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 25
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Gatling Laser",
                    category: "Heavy",
                    explosive: false,
                    silencer: false,
                    speed: 9.1,
                    level: [25, 35, 45],
                    damage: [0, 0, 0],
                    damageEnergy: [18, 21, 25],
                    mods: [
                        {
                            slot: "Capacitor",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Ultracite Gatling Laser",
                    category: "Heavy",
                    explosive: false,
                    silencer: false,
                    speed: 9.1,
                    level: [35, 45],
                    damage: [0, 0, 0],
                    damageEnergy: [25, 28],
                    mods: [
                        {
                            slot: "Capacitor",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Prime",
                                    damageMultPercent: 25,
                                    versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                                    versusMultPercent: 35
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Plasma Pistol",
                    category: "Pistol",
                    explosive: false,
                    silencer: false,
                    speed: 3.3,
                    level: [15, 25, 35, 45],
                    damage: [15, 21, 25, 29],
                    damageEnergy: [15, 21, 25, 29],
                    mods: [
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Flamer",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Splitter",
                                    damageMultPercent: 10
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 50
                                }
                                ,
                                {
                                    name: "Automatic",
                                    damageMultPercent: -15
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Plasma Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: false,
                    speed: 3.3,
                    level: [15, 25, 35, 45],
                    damage: [15, 21, 25, 29],
                    damageEnergy: [15, 21, 25, 29],
                    mods: [
                    {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Flamer",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Splitter",
                                    damageMultPercent: 10
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 50
                                }
                                ,
                                {
                                    name: "Automatic",
                                    damageMultPercent: -15
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Gatling Plasma",
                    category: "Heavy",
                    explosive: false,
                    silencer: false,
                    speed: 9.1,
                    level: [30, 40, 50],
                    damage: [43, 50, 58],
                    damageEnergy: [43, 50, 58],
                    mods: [
                    
                    ]
                },
                {
                    name: "Enclave Plasma Pistol",
                    category: "Pistol",
                    explosive: false,
                    silencer: false,
                    speed: 3.3,
                    level: [25, 35, 45],
                    damage: [24, 28, 32],
                    damageEnergy: [24, 28, 32],
                    mods: [
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Flamer",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Splitter",
                                    damageMultPercent: 10
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 50
                                }
                                ,
                                {
                                    name: "Automatic",
                                    damageMultPercent: -15
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Enclave Plasma Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: false,
                    speed: 3.3,
                    level: [25, 35, 45],
                    damage: [24, 28, 32],
                    damageEnergy: [24, 28, 32],
                    mods: [
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Flamer",
                                    damageMultPercent: 25
                                },
                                {
                                    name: "Splitter",
                                    damageMultPercent: 10
                                },
                                {
                                    name: "Sniper",
                                    damageMultPercent: 50
                                }
                                ,
                                {
                                    name: "Automatic",
                                    damageMultPercent: -15
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Gamma Gun",
                    category: "Pistol",
                    explosive: false,
                    silencer: false,
                    speed: 6.7,
                    level: [15, 25, 35, 45],
                    damage: [38, 45, 52, 60],
                    damageRadiation: [50, 50, 50, 50],
                    mods: [
                        {
                            slot: "Dish",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Deep Dish",
                                    addDamageRadiationLeveled: [75, 75, 75, 75]
                                }
                            ]
                        },
                        {
                            slot: "Muzzle",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Electric signal carrier",
                                    addDamageEnergyLeveled: [40, 40, 40, 40]
                                },
                                {
                                    name: "Signal Repeater",
                                    speedMultPercent: speedMult(9.1, 6.7)
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Tesla Rifle",
                    category: "Rifle",
                    explosive: false,
                    silencer: false,
                    speed: 2,
                    level: [40, 50],
                    damage: [0, 0],
                    damageEnergy: [66, 78],
                    mods: [
                        {
                            slot: "Receiver",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Automatic",
                                    damageMultPercent: -15,
                                    speedMultPercent: speedMult(9.1, 2)
                                },
                                {
                                    name: "Charging",
                                    damageMultPercent: 30
                                },
                            ]
                        }
                    ]
                },
                {
                    name: "Cryolator",
                    category: "Heavy",
                    explosive: false,
                    silencer: false,
                    speed: 9.1,
                    level: [25, 35, 45],
                    damage: [0, 0, 0],
                    damageEnergy: [24, 30, 36],
                    mods: [
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Chrystallizing",
                                    damageMultPercent: -25,
                                    speedMultPercent: -25,
                                    addDamageBallisticLeveled: [25 / 0.75, 25 / 0.75, 25 / 0.75]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Fat Man",
                    category: "Heavy",
                    explosive: true,
                    speed: 0.2,
                    level: [25, 35, 45],
                    damage: [355, 405, 455],
                    mods: [
                        {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "MIRV",
                                    addDamageBallisticLeveled: [145, 145, 145]
                                }
                            ]
                        }
                    ]
                },
                {
                    name: "Missile Launcher",
                    category: "Heavy",
                    explosive: true,
                    speed: 0.2,
                    level: [20, 30, 40, 50],
                    damage: [105, 125, 145, 155],
                    mods: [
                    ]
                },
                {
                    name: "M79 Grenade Launcher",
                    category: "Heavy",
                    explosive: true,
                    speed: 0.2,
                    level: [15, 25, 35, 45],
                    damage: [90, 100, 110, 120],
                    mods: [
                    ]
                },
                {
                    name: "Auto Grenade Launcher",
                    category: "Heavy",
                    explosive: true,
                    speed: 10,
                    level: [50],
                    damage: [75],
                    mods: [
                    {
                            slot: "Barrel",
                            options: [
                                {
                                    name: "Standard"
                                },
                                {
                                    name: "Heavy",
                                    damageMultPercent: 10,
                                }
                            ]
                        }
                    ]
                },
            ]);

            // uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu

            var enemyResistances = [
                { dr: 1, er: 1, rr: 1 },
                { dr: 5, er: 5, rr: 5 },
                { dr: 5, er: 5, rr: 250 },
                { dr: 5, er: 20, rr: 150 },
                { dr: 10, er: 5, rr: 10 },
                { dr: 10, er: 10, rr: 10 },
                { dr: 10, er: 20, rr: 1000 },
                { dr: 10, er: 20, rr: 250 },
                { dr: 10, er: 20, rr: 150 },
                { dr: 15, er: 10, rr: 15 },
                { dr: 15, er: 15, rr: 15 },
                { dr: 20, er: 20, rr: 20 },
                { dr: 20, er: 20, rr: 150 },
                { dr: 20, er: 30, rr: 1000 },
                { dr: 25, er: 15, rr: 15 },
                { dr: 25, er: 15, rr: 25 },
                { dr: 25, er: 25, rr: 25 },
                { dr: 25, er: 25, rr: 250 },
                { dr: 30, er: 30, rr: 250 },
                { dr: 30, er: 40, rr: 250 },
                { dr: 30, er: 45, rr: 1000 },
                { dr: 40, er: 30, rr: 40 },
                { dr: 40, er: 50, rr: 250 },
                { dr: 40, er: 60, rr: 1000 },
                { dr: 40, er: 65, rr: 150 },
                { dr: 45, er: 40, rr: 200 },
                { dr: 50, er: 25, rr: 250 },
                { dr: 50, er: 25, rr: 50 },
                { dr: 50, er: 35, rr: 350 },
                { dr: 50, er: 50, rr: 1 },
                { dr: 50, er: 50, rr: 50 },
                { dr: 50, er: 60, rr: 250 },
                { dr: 50, er: 65, rr: 150 },
                { dr: 50, er: 75, rr: 250 },
                { dr: 50, er: 75, rr: 1000 },
                { dr: 50, er: 100, rr: 250 },
                { dr: 60, er: 30, rr: 60 },
                { dr: 60, er: 65, rr: 150 },
                { dr: 60, er: 90, rr: 1000 },
                { dr: 70, er: 100, rr: 150 },
                { dr: 75, er: 50, rr: 75 },
                { dr: 75, er: 75, rr: 250 },
                { dr: 80, er: 70, rr: 80 },
                { dr: 80, er: 100, rr: 150 },
                { dr: 85, er: 140, rr: 1000 },
                { dr: 90, er: 50, rr: 250 },
                { dr: 90, er: 90, rr: 250 },
                { dr: 90, er: 100, rr: 150 },
                { dr: 90, er: 250, rr: 250 },
                { dr: 100, er: 50, rr: 100 },
                { dr: 100, er: 75, rr: 250 },
                { dr: 100, er: 100, rr: 100 },
                { dr: 100, er: 100, rr: 250 },
                { dr: 100, er: 100, rr: 150 },
                { dr: 100, er: 250, rr: 250 },
                { dr: 110, er: 60, rr: 250 },
                { dr: 110, er: 100, rr: 110 },
                { dr: 110, er: 250, rr: 250 },
                { dr: 115, er: 230, rr: 1000 },
                { dr: 120, er: 250, rr: 250 },
                { dr: 125, er: 100, rr: 125 },
                { dr: 125, er: 125, rr: 250 },
                { dr: 125, er: 125, rr: 125 },
                { dr: 130, er: 70, rr: 250 },
                { dr: 130, er: 75, rr: 130 },
                { dr: 135, er: 70, rr: 135 },
                { dr: 135, er: 80, rr: 135 },
                { dr: 135, er: 135, rr: 135 },
                { dr: 150, er: 75, rr: 75 },
                { dr: 150, er: 100, rr: 150 },
                { dr: 150, er: 125, rr: 350 },
                { dr: 150, er: 150, rr: 150 },
                { dr: 150, er: 150, rr: 250 },
                { dr: 150, er: 250, rr: 250 },
                { dr: 175, er: 100, rr: 175 },
                { dr: 175, er: 175, rr: 250 },
                { dr: 200, er: 100, rr: 250 },
                { dr: 200, er: 150, rr: 250 },
                { dr: 200, er: 200, rr: 200 },
                { dr: 250, er: 200, rr: 250 },
                { dr: 250, er: 250, rr: 250 },
                { dr: 300, er: 150, rr: 150 },
                { dr: 300, er: 300, rr: 300 },
            ];

            enemyResistances.sort(function(a, b) {
                if (a.dr < b.dr) {
                    return -1;
                }
                if (a.dr > b.dr) {
                    return 1;
                }
                if (a.er < b.er) {
                    return -1;
                }
                if (a.er > b.er) {
                    return 1;
                }
                if (a.rr < b.rr) {
                    return -1;
                }
                if (a.rr > b.rr) {
                    return 1;
                }
                return 0;
            });

            // vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv

            allEffects.set("Melee", [
                // 1: Prefix
                [
                    {
                        name: "Executioner's",
                        damageMultPercent: 50
                    },
                    {
                        name: "Exterminator's",
                        versus: ["Bug", "Mirelurk"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Anti-armor",
                        ignoreDRPercent: 50
                    },
                    {
                        name: "Nocturnal",
                        damageMultPercent: 30
                    },
                    {
                        name: "Zealot's",
                        versus: ["Scorched"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Hunter's",
                        versus: ["Animal"],
                        damageMultPercent: 30
                    },
                    {
                        name: "Mutant slayer's",
                        versus: ["Mutant"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Mutant's",
                        damageMultPercent: 10
                    },
                    {
                        name: "Ghoul slayer's",
                        versus: ["Ghoul"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Bloodied",
                        damageMultPercent: 60
                    },
                    {
                        name: "Troubleshooter's",
                        versus: ["Robot"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Instigating",
                        damageMultPercent: 100
                    },
                    {
                        name: "Furious"
                    },
                    {
                        name: "Junkie's"
                    },
                ],
                // 2: Major
                [
                    {
                        name: "40% increased swing speed",
                        speedMultPercent: 40
                    }
                ],
                // 3: minor
                [
                    {
                        name: "Strength",
                        text: "+1 Strength"
                        // no multiplier, considered with the base calculation
                    }
                ]
            ]);

            allEffects.set("Ranged", [
                // 1: Prefix
                [
                    {
                        name: "Executioner's",
                        damageMultPercent: 50
                    },
                    {
                        name: "Furious",
                    },
                    {
                        name: "Exterminator's",
                        versus: ["Bug", "Mirelurk"],
                        versusAddPercent: 50
                    },
                    {
                        name: "Two shot",
                        damageMultPercent: 25
                    },
                    {
                        name: "Two shot (pre nerf)",
                        damageMultPercent: 100
                    },
                    {
                        name: "Anti-armor",
                        ignoreDRPercent: 50
                    },
                    {
                        name: "Nocturnal",
                        damageMultPercent: 30
                    },
                    {
                        name: "Zealot's",
                        versus: ["Scorched", "Scorchbeast", "Scorchbeast Queen"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Hunter's",
                        versus: ["Animal"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Mutant slayer's",
                        versus: ["Mutant"],
                        damageMultPercent: 30
                    },
                    {
                        name: "Mutant's",
                        damageMultPercent: 10
                    },
                    {
                        name: "Ghoul slayer's",
                        versus: ["Ghoul"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Bloodied",
                        damageMultPercent: 60
                    },
                    {
                        name: "Instigating",
                        damageMultPercent: 100
                    },
                    {
                        name: "Troubleshooter's",
                        versus: ["Robot"],
                        versusAddPercent: 30
                    },
                    {
                        name: "Junkie's"
                    },
                ],
                // 2: Major
                [
                    {
                        name: "Explosive",
                        damageMultPercent: 20
                    },
                    {
                        name: "ExplosiveOld",
                        text: "Explosive (pre nerf)",
                        damageMultPercent: 100
                    },
                    {
                        name: "Aiming",
                        text: "+10% damage while aiming",
                        damageMultPercent: 10
                    },
                    {
                        name: "25% increased fire rate",
                        speedMultPercent: 25
                    }
                ],
                // 3: minor
                [

                ]
            ]);

            // -------------------------------------------------------------------------------------
            enemyCategories = [];
            addEnemy("Scorched", ["Scorched"]);

            addEnemy("Feral Ghoul", ["Ghoul"]);

            addEnemy("Glowing One", ["Ghoul", "Glowing"]);

            addEnemy("Super Mutant", ["Mutant"]);

            addEnemy("Super Mutant Behemoth", ["Mutant"]);

            addEnemy("Mutant Hound", ["Animal"]);
            addEnemy("Glowing Mutant Hound", ["Animal", "Glowing"]);
            addEnemy("Scorched Mutant Hound", ["Scorched"]);

            addEnemy("Radroach", ["Bug"]);
            addEnemy("Glowing Radroach", ["Bug", "Glowing"]);
            addEnemy("Scorched Radroach", ["Scorched"]);

            addEnemy("Stingwing", ["Bug"]);
            addEnemy("Glowing Stingwing", ["Bug", "Glowing"]);
            addEnemy("Scorched Stingwing", ["Scorched"]);

            addEnemy("Bloatfly", ["Bug"]);
            addEnemy("Glowing Bloatfly", ["Bug", "Glowing"]);
            addEnemy("Scorched Bloatfly", ["Scorched"]);

            addEnemy("Mirelurk Crab", ["Mirelurk"]);
            addEnemy("Glowing Mirelurk", ["Mirelurk", "Glowing"]);
            addEnemy("Scorched Mirelurk", ["Scorched"]);

            addEnemy("Mirelurk King", ["Mirelurk"]);
            addEnemy("Glowing Mirelurk King", ["Mirelurk", "Glowing"]);
            addEnemy("Scorched Mirelurk King", ["Scorched"]);

            addEnemy("Mirelurk Queen", ["Mirelurk"]);
            addEnemy("Glowing Mirelurk Queen", ["Mirelurk", "Glowing"]);
            addEnemy("Scorched Mirelurk Queen", ["Scorched"]);

            addEnemy("Mirelurk Spawn", ["Mirelurk"]);
            addEnemy("Glowing Mirelurk Spawn", ["Mirelurk", "Glowing"]);
            addEnemy("Scorched Mirelurk Spawn", ["Scorched"]);

            addEnemy("Scorchbeast", ["Animal", "Scorchbeast"]);
            addEnemy("Scorchbeast Queen", ["Animal", "Scorchbeast", "Scorchbeast Queen"]);

            addEnemy("Yao Guai", ["Animal"]);
            addEnemy("Glowing Yao Guai", ["Animal", "Glowing"]);
            addEnemy("Scorched Yao Guai", ["Animal", "Scorched"]);

            addEnemy("Deathclaw", ["Animal"]);
            addEnemy("Glowing Deathclaw", ["Animal", "Glowing"]);
            addEnemy("Scorched Deathclaw", ["Scorched"]);

            addEnemy("Ant", ["Bug"]);
            addEnemy("Glowing Ant", ["Bug", "Glowing"]);
            addEnemy("Scorched Ant", ["Scorched"]);

            addEnemy("Protectron", ["Robot"]);
            addEnemy("Robobrain", ["Robot"]);
            addEnemy("Sentrybot", ["Robot"]);
            addEnemy("Assaultron", ["Robot"]);
            addEnemy("Eyebot", ["Robot"]);

            // some enemies are immune to radiation or even heal off it
            var enemyRadiationEffect = new Map();

            enemyRadiationEffect.set("Feral Ghoul", -10);
            enemyRadiationEffect.set("Glowing One", -10);
            enemyRadiationEffect.set("Scorchbeast Queen", 0);

            // -------------------------------------------------------------------------------------
            
            function addEnemy(name, keywords) {
                enemyCategories.push({ name: name, keywords: keywords});
            }

            allWeapons.get("Melee").sort(function(a, b) {
                return a.name.localeCompare(b.name);
            });
            allWeapons.get("Ranged").sort(function(a, b) {
                return a.name.localeCompare(b.name);
            });

            enemyCategories.sort(function(a, b) {
                return a.name.localeCompare(b.name);
            });

            allEffects.get("Melee").forEach(function(eff) {
                eff.sort(function(a, b) {
                    return a.name.localeCompare(b.name);
                });
            });

            allEffects.get("Ranged").forEach(function(eff) {
                eff.sort(function(a, b) {
                    return a.name.localeCompare(b.name);
                });
            });

            function speedMult(target, base) {
                return 100.0 * (target / base - 1);
            }

            // -------------------------------------------------------------------------------
            // Setup main selection
            // -------------------------------------------------------------------------------

            document.getElementById("wtRanged1").onclick = function() {
                createSelectWeapon(document.getElementById("table1"), 1, "Ranged")
            };
            document.getElementById("spRanged1").onclick = function() {
                document.getElementById("wtRanged1").checked = true;
                createSelectWeapon(document.getElementById("table1"), 1, "Ranged")
            };

            document.getElementById("wtMelee1").onclick = function() {
                createSelectWeapon(document.getElementById("table1"), 1, "Melee")
            };
            document.getElementById("spMelee1").onclick = function() {
                document.getElementById("wtMelee1").checked = true;
                createSelectWeapon(document.getElementById("table1"), 1, "Melee")
            };

            document.getElementById("wtRanged2").onclick = function() {
                createSelectWeapon(document.getElementById("table2"), 2, "Ranged")
            };
            document.getElementById("spRanged2").onclick = function() {
                document.getElementById("wtRanged2").checked = true;
                createSelectWeapon(document.getElementById("table2"), 2, "Ranged")
            };

            document.getElementById("wtMelee2").onclick = function() {
                createSelectWeapon(document.getElementById("table2"), 2, "Melee")
            };
            document.getElementById("spMelee2").onclick = function() {
                document.getElementById("wtMelee2").checked = true;
                createSelectWeapon(document.getElementById("table2"), 2, "Melee")
            };

            // ......................................

            document.getElementById("damagemode").onclick = function() {
                recalculateDiff();
            };
            document.getElementById("spdamagemode").onclick = function() {
                document.getElementById("damagemode").checked = true;
                recalculateDiff();
            };

            document.getElementById("dpsmode").onclick = function() {
                recalculateDiff();
            };
            document.getElementById("spdpsmode").onclick = function() {
                document.getElementById("dpsmode").checked = true;
                recalculateDiff();
            };

            // ======================================================================

            var infoMap = new Map();

            infoMap.set("furious", "With the <b>Furious</b> legendary prefix on a weapon, each consecutive hit increases the damage by 5% up to 45% total.");
            infoMap.set("bloodymess", "Each level adds 5% damage and 5% chance of enemies exploding into bits.");
            infoMap.set("adrenaline", 
                "Kills increases damage up to a maximum percentage."
                + "<table class='infoTable'>"
                + "<tr><td>Level 1</td><td>+6% damage per kill</td><td>+36% maximum</td></tr>"
                + "<tr><td>Level 2</td><td>+7% damage per kill</td><td>+42% maximum</td></tr>"
                + "<tr><td>Level 3</td><td>+8% damage per kill</td><td>+48% maximum</td></tr>"
                + "<tr><td>Level 4</td><td>+9% damage per kill</td><td>+54% maximum</td></tr>"
                + "<tr><td>Level 5</td><td>+10% damage per kill</td><td>+60% maximum</td></tr>"
                + "</table>"
            );
            infoMap.set("weaponperk", 
                "Weapon specific perks with 3 ranks and 3 levels each presented as a percentage bonus between 10% and 60%."
                + "<br>Example: <b>Rifleman 2</b> (+15%), <b>Expert Rifleman 1</b> (+10%) and <b>Master Rifleman 3</b> (+20%) totals 45%"
            );
            infoMap.set("demolitionexpert", "Ranged weapons only. Affects the <b>Explosive</b> legendary effect or the base damage on explosive weapons.");
            infoMap.set("tankkiller", "Rifles only. Each level ignores 12% more armor up to 36% total.");
            infoMap.set("stabilized", "Heavy ballistic weapons only. Each level ignores 15% more armor up to 45% total.");
            infoMap.set("incisor", "Melee weapons only. Each level ignores 25% more armor up to 75% total.");
            infoMap.set("covertoperative", "Ranged weapons only. Sets the sneak attack multiplier to 2.15x, 2.3x and 2.5x.");
            infoMap.set("exterminator", "Each level ignores 25% more armor of Bugs and Mirelurks up to 75% total.");
            infoMap.set("glowsight", "Each level adds 20% damage against Glowing enemies up to 60% total.");
            infoMap.set("nerdrage", "If the player health is below 20%, gain 10%, 15% and 20% damage based on the perk level.");
            infoMap.set("revenant", "Bonus damage after another player revives you. Each level adds 25% more damage up to 50% total.");
            infoMap.set("sandman", "Silenced weapons only. Night only. Each level adds 25% more sneak attack damage up to 50% total.");
            infoMap.set("adrenalreaction", 
                "Damage increased the lower the player's health is, up to 50%."
                + "<br>When the Strange In Numbers perk is equipped, there benefits are increased by 25%."
                + "<table class='infoTable'>"
                + "<tr><td><b>Health</b></td><td><b>Normal</b></td><td><b>Strange in Numbers perk</b></td></tr>"
                + "<tr><td>health &gt; 90%</td><td>No change</td><td>No change</td></tr>"
                + "<tr><td>health &gt; 80%</td><td>+6% damage</td><td>+8% damage</td></tr>"
                + "<tr><td>health &gt; 70%</td><td>+13% damage</td><td>+16% damage</td></tr>"
                + "<tr><td>health &gt; 60%</td><td>+19% damage</td><td>+24% damage</td></tr>"
                + "<tr><td>health &gt; 50%</td><td>+25% damage</td><td>+31% damage</td></tr>"
                + "<tr><td>health &gt; 40%</td><td>+31% damage</td><td>+39% damage</td></tr>"
                + "<tr><td>health &gt; 30%</td><td>+38% damage</td><td>+48% damage</td></tr>"
                + "<tr><td>health &gt; 20%</td><td>+44% damage</td><td>+55% damage</td></tr>"
                + "<tr><td>health &gt; 0%</td><td>+50% damage</td><td>+63% damage</td></tr>"
                + "</table><br/>"
            );
            infoMap.set("strangeinnumbers", 
                "Positive mutation effects are 25% stronger if teammates are mutated too."
                + "<br>Improves the following mutations:"
                + "<ul>"
                    + "<li>Adrenal Reaction</li>"
                + "</ul>"
            );
            infoMap.set("nighttime", 
                "Enables the following effects/mods/perks when at night:"
                + "<ul>"
                    + "<li>Nocturnal (legenary prefix)</li>"
                    + "<li>Mister Sandman (perk)</li>"
                + "</ul>"
            );
            infoMap.set("sneaking", 
                "Enables the following effects/mods/perks when sneaking:"
                + "<ul>"
                    + "<li>Ninja (melee perk)</li>"
                    + "<li>Covert operative (ranged perk)</li>"
                + "</ul>"
            );
            infoMap.set("aiming", 
                "Enables the effects/mods/perks when aiming down the sights:"
                + "<ul>"
                    + "<li>+10% damage while aiming (legendary major)</li>"
                + "</ul>"
            );

            infoMap.set("playerhealth", 
                "Enables the following effects/mods/perks when player is not at full health:"
                + "<ul>"
                    + "<li>Bloodied (legendary prefix)</li>"
                    + "<li>Adrenal Reaction (mutation)</li>"
                    + "<li>Nerd Rage (perk)</li>"
                + "</ul>"
            );

            infoMap.set("enemyhealth", 
                "Enables the following effects/mods/perks:"
                + "<ul>"
                    + "<li>Instigating (legendary prefix): double damage if the enemy is at full health</li>"
                    + "<li>Executioner's (legendary prefix): +50% damage if the enemy is below 40% health</li>"
                + "</ul>"
            );

            infoMap.set("enemytype", 
                "Enables the following effects/mods/perks when hitting a specific enemy type:"
                + "<ul>"
                    + "<li>Scorch Killer's (mod): bonus damage against Scorched enemies</li>"
                    + "<li>Prime (mod): bonus damage against Scorched enemies, Scorchbeasts and the Scorchbeast Queen</li>"
                    + "<li>Exterminator's (legendary prefix): bonus damage against Bugs and Mirelurks</li>"
                    + "<li>Ghoul slayer's (legendary prefix): bonus damage against Ghouls</li>"
                    + "<li>Hunter's (legendary prefix): bonus damage against Animals</li>"
                    + "<li>Mutant slayer's (legendary prefix): bonus damage against Super Mutants</li>"
                    + "<li>Troubleshooter's (legendary prefix): bonus damage against Robots</li>"
                    + "<li>Zealot's (legendary prefix): bonus damage against Scorched enemies</li>"
                    + "<li>Exterminator's (perk): ignore armor of Bugs and Mirelurks</li>"
                    + "<li>Glow sight (perk): bonus damage against Glowing enemies</li>"
                + "</ul>"
            );

            infoMap.set("strength", 
                "Each point in the Strength attribute of the player adds 5% damage."
                + "<br>Armor, chems, mutations and legendary effects can increase player strength beyond 15."
                + "<br>This damage boost is additive and proportional to the base weapon damage and is considered before "
                + "<br>weapon mods, effects, perks, chems and other player conditions not related to strength."
            );

            infoMap.set("ninja", "Melee weapons only. Sets the sneak attack multiplier 2.3x, 2.6x and 3.x.");

            infoMap.set("buff", 
                "Set positive or negative damage boosts coming from chems, equipment or other effects."
                + "<br>Note that boosts are typically multiplicative, thus a +50% and a +25% damage boost"
                + "<br>is not +75% boost but 1.5 * 1.25 = 1.875 or 87.5%."

            );

            infoMap.set("martialartist", "Melee weapons only. Each level increases swing speed by 10% and up to 30% total.");

            infoMap.set("mutation", 
                "Enables the following effects/mods/perks when the player is mutated:"
                + "<ul>"
                    + "<li>Mutant's (legendary prefix): bonus damage when mutated</li>"
                + "</ul>"
            );
            infoMap.set("ActualDR", 
                "Shows the Damage Resistance against ballistic damage after all Ignore Armor mods/effects/perks have been applied to the target."
                + " Note that Ignore Armor does not currently work with radiation weapons and against radiation resistance."
            );
            infoMap.set("ActualER", 
                "Shows the Damage Resistance against energy damage after all Ignore Armor mods/effects/perks have been applied to the target."
                + " Note that Ignore Armor does not currently work with radiation weapons and against radiation resistance."
            );
            infoMap.set("junkies", "With the <b>Junkie's</b> legendary prefix on a weapon, each addiction results in a +10% damage bonus up to +50% total.");


            // add HTML explanation marker
            function info(name) {
                return "&nbsp;<sup><a href='#' style='font-size: 14; font-weight: bold;' onclick='showinfo(this, \"" + name + "\"); return false;'>?</a></sup>";
            }

            // popup for explanation
            function showinfo(target, name) {
                var div = document.getElementById("InfoDiv" + name);
                if (div == null) {
                    var div = document.createElement("div");
                    div.style.border = "1px solid black";
                    div.style.padding = "3px";
                    div.style.position = "absolute";
                    div.style.backgroundColor = "#FFFFD0";
                    div.style.zIndex = 99;
                    div.id = "InfoDiv" + name;
                    var txt = infoMap.get(name);

                    if (txt == null) {
                        txt = "??? " + name + " ???";
                    }
                    txt += "<hr><font style='font-size: 14px'>Click to close.</font>";
                    div.innerHTML = txt;

                    target.parentElement.appendChild(div);
                    div.onclick = function() {
                        target.parentElement.removeChild(div);
                    }
                } else {
                    target.parentElement.removeChild(div);
                }
            }


            document.getElementById("ActualDRLeft").innerHTML =
                document.getElementById("ActualDRLeft").innerHTML + info("ActualDR");
            document.getElementById("ActualERLeft").innerHTML =
                document.getElementById("ActualERLeft").innerHTML + info("ActualER");

            document.getElementById("ActualDRRight").innerHTML =
                document.getElementById("ActualDRRight").innerHTML + info("ActualDR");
            document.getElementById("ActualERRight").innerHTML =
                document.getElementById("ActualERRight").innerHTML + info("ActualER");


            // ----------------------------------------------------------------------

            function clearTable(tbl) {
                for (var i = tbl.rows.length - 1; i > 0; i--) {
                    tbl.deleteRow(i);
                }
            }
            function clearTable2(tbl) {
                for (var i = tbl.rows.length - 1; i > 1; i--) {
                    tbl.deleteRow(i);
                }
            }

            function createSelectWeapon(tbl, index, type) {
                clearTable(tbl);

                var row = tbl.insertRow(1);

                var cell1 = row.insertCell(0);
                cell1.innerText = "Weapon";

                var cell2 = row.insertCell(1);



                var weaps = allWeapons.get(type);

                if (weaps.length == 0) {
                    cell2.innerHTML = "No weapon data available";
                } else {

                    cell2.innerHTML = "<select id='weapon" + index + "'></select> ("
                    + weaps.length + ")";
                    var selector = document.getElementById("weapon" + index);

                    weaps.forEach(function(weap) {
                        var opt = document.createElement("option");
                        opt.text = weap.name;
                        opt.value = weap.name;
                        selector.add(opt);
                    });
                    selector.selectedIndex = -1;

                    selector.onchange = function() {
                        clearTable2(tbl);
                        createSelectLevel(tbl, index, type);
                        createSelectMods(tbl, index, type);
                        createSelectLegendary(tbl, index, type);
                        createSelectLegendaryParameter(tbl, index, type);
                        createPerks(tbl, index, type);
                        createMutations(tbl, index, type);
                        createOther(tbl, index, type);
                        recalculate(tbl, index, type);
                    };
                }
            }

            function createSelectLevel(tbl, index, type) {
                var cell2 = document.getElementById("levels" + index);

                if (cell2 == null) {
                    var row = tbl.insertRow(tbl.rows.length);

                    var cell1 = row.insertCell(0);
                    cell1.innerText = "Level";
                    cell1.style = "border-top: 1px solid black;"

                    cell2 = row.insertCell(1);
                    cell2.id = "levels" + index;
                    cell2.style = "border-top: 1px solid black;"
                }

                cell2.innerHTML = "<select id='level" + index + "'></select>"

                var levelsel = document.getElementById("level" + index);

                var weapIdx = document.getElementById("weapon" + index).selectedIndex;
                var weap = allWeapons.get(type)[weapIdx];

                weap.level.forEach(function(item, idx) {
                    opt = document.createElement("option");
                    levelsel.add(opt);

                    opt.text = item;
                    opt.value = "" + idx;
                });
                levelsel.selectedIndex = weap.level.length - 1;
                levelsel.onchange = function() {
                    recalculate(tbl, index, type);
                };
            }

            function createSelectMods(tbl, index, type) {
                var weapIdx = document.getElementById("weapon" + index).selectedIndex;
                var weap = allWeapons.get(type)[weapIdx];

                var row = tbl.insertRow(tbl.rows.length);

                var cell1 = row.insertCell(0);
                cell1.innerText = "Mods";

                cell2 = row.insertCell(1);
                cell2.id = "mods" + index;

                if (weap.mods.length == 0) {
                    cell2.innerText = "No damage-related mods";
                }

                weap.mods.forEach(function(item, idx) {

                    var modRow = tbl.insertRow(tbl.rows.length);

                    var modCell1 = modRow.insertCell(0);
                    modCell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;" + item.slot;

                    var modCell2 = modRow.insertCell(1);

                    var modSelector = document.createElement("select");
                    modSelector.id = "mods_" + index + "_" + idx;
                    modCell2.appendChild(modSelector);

                    var selIdx = 0;
                    item.options.forEach(function(modItem, modIdx) {
                        var modOpt = document.createElement("option");
                        modSelector.add(modOpt);
                        modOpt.value = "" + modIdx;
                        modOpt.text = modItem.name;
                        if (modItem.preinstalled) {
                            selIdx = modIdx;
                        }
                    });
                    modSelector.selectedIndex = selIdx;

                    modSelector.onchange = function() {
                        recalculate(tbl, index, type);
                    };
                });
            }

            function createSelectLegendary(tbl, index, type) {
                var weapIdx = document.getElementById("weapon" + index).selectedIndex;
                var weap = allWeapons.get(type)[weapIdx];

                var row = tbl.insertRow(tbl.rows.length);

                var cell1 = row.insertCell(0);
                cell1.innerText = "Legendary effects";

                var titles = ["Prefix", "Major", "Minor"];

                var effects = allEffects.get(type);
                effects.forEach(function(effect, idx) {
                    var effRow = tbl.insertRow(tbl.rows.length);

                    var effCell1 = effRow.insertCell(0);
                    effCell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;" + titles[idx];

                    var effCell2 = effRow.insertCell(1);

                    if (effect.length == 0) {
                        effCell2.innerText = "No damage-related legendary effect";
                    } else {
                        var effSelector = document.createElement("select");
                        effSelector.id = "effs_" + index + "_" + idx;
                        effCell2.appendChild(effSelector);

                        var effOpt = document.createElement("option");
                            effSelector.add(effOpt);
                            effOpt.value = "";
                            effOpt.text = "";

                            effect.forEach(function(effItem, effIdx) {
                                if (!(effItem.name.includes("Explosive") && weap.explosive)) {
                                    effOpt = document.createElement("option");
                                    effSelector.add(effOpt);
                                    effOpt.value = "" + effIdx;
                                    if (effItem.text !== undefined) {
                                        effOpt.text = effItem.text;
                                    } else {
                                        effOpt.text = effItem.name;
                                    }
                                }
                            });
                        

                        effSelector.onchange = function() {
                            recalculate(tbl, index, type);
                        };
                    }
                });
            }

            function createSelectLegendaryParameter(tbl, index, type) {
                var row = tbl.insertRow(tbl.rows.length);
                var cell1 = row.insertCell(0);
                cell1.innerText = "Effect parameters";
                var cell2 = row.insertCell(1);

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Night time" + info("nighttime");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='radio' id='nighttime" + index + "_yes' name='nighttime" + index + "' value='1'> Yes&nbsp;&nbsp;&nbsp;"
                    + "<input type='radio' id='nighttime" + index + "_no' name='nighttime" + index + "' value='0' checked='checked'> No";

                document.getElementById("nighttime" + index + "_yes").onchange = function() {
                    recalculate(tbl, index, type);
                };
                document.getElementById("nighttime" + index + "_no").onchange = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Sneaking" + info("sneaking");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='radio' id='sneaking" + index + "_yes' name='sneaking" + index + "' value='1'> Yes&nbsp;&nbsp;&nbsp;"
                    + "<input type='radio' id='sneaking" + index + "_no' name='sneaking" + index + "' value='0' checked='checked'> No";

                document.getElementById("sneaking" + index + "_yes").onchange = function() {
                    recalculate(tbl, index, type);
                };
                document.getElementById("sneaking" + index + "_no").onchange = function() {
                    recalculate(tbl, index, type);
                };

                if (type === "Ranged") {
                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Aiming" + info("aiming");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<input type='radio' id='aiming" + index + "_yes' name='aiming" + index + "' value='1'> Yes&nbsp;&nbsp;&nbsp;"
                        + "<input type='radio' id='aiming" + index + "_no' name='aiming" + index + "' value='0' checked='checked'> No";

                    document.getElementById("aiming" + index + "_yes").onchange = function() {
                        recalculate(tbl, index, type);
                    };
                    document.getElementById("aiming" + index + "_no").onchange = function() {
                        recalculate(tbl, index, type);
                    };

                }

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Player health" + info("playerhealth");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='number' id='playerhealth" + index + "' value='100' maxlength='6' style='width: 8em;' min='1' max='100'> %";
                document.getElementById("playerhealth" + index ).oninput = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Enemy health" + info("enemyhealth");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='number' id='enemyhealth" + index + "' value='99' maxlength='6' style='width: 8em;' min='1' max='100'> %";
                document.getElementById("enemyhealth" + index ).oninput = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Enemy type" + info("enemytype");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<select id='enemytype" + index + "'></select>"

                var enemytypesel = document.getElementById("enemytype" + index);
                var opt = document.createElement("option");
                enemytypesel.add(opt);
                opt.text = "Any";
                opt.value = "";

                if (type === "Melee") {
                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Strength" + info("strength");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<input type='number' id='strength" + index + "' value='1' maxlength='6' style='width: 8em;' min='1' max='50'> (points)";
                    document.getElementById("strength" + index ).oninput = function() {
                        recalculate(tbl, index, type);
                    };
                }

                enemyCategories.forEach(function(item, idx) {
                    opt = document.createElement("option");
                    enemytypesel.add(opt);

                    opt.text = item.name;
                    opt.value = item.keywords.join();
                });

                enemytypesel.onchange = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Furious hit count" + info("furious");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<input type='number' id='furioushits" + index + "' value='0' maxlength='6' style='width: 8em;' min='0' max='30'>";
                    document.getElementById("furioushits" + index ).oninput = function() {
                        recalculate(tbl, index, type);
                    };

                row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Addictions" + info("junkies");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<input type='number' id='junkiescount" + index + "' value='0' maxlength='6' style='width: 8em;' min='0' max='30'>";
                    document.getElementById("junkiescount" + index ).oninput = function() {
                        recalculate(tbl, index, type);
                    };
            }

            function createPerks(tbl, index, type) {
                var weapIdx = document.getElementById("weapon" + index).selectedIndex;
                var weap = allWeapons.get(type)[weapIdx];

                var row = tbl.insertRow(tbl.rows.length);
                var cell1 = row.insertCell(0);
                cell1.innerText = "Perks";
                var cell2 = row.insertCell(1);

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Bloody mess" + info("bloodymess");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<select id='bloodymess" + index + "'></select> (level)"

                var bloodymesssel = document.getElementById("bloodymess" + index);
                var opt = document.createElement("option");
                bloodymesssel.add(opt);
                opt.text = "None";
                opt.value = "0";

                for (var i = 1; i < 4; i++) {
                    opt = document.createElement("option");
                    bloodymesssel.add(opt);
                    opt.text = "" + i;
                    opt.value = "" + (i * 5);
                }
                bloodymesssel.selectedIndex = 0;
                bloodymesssel.onchange = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Adrenaline" + info("adrenaline");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<select id='adrenaline" + index + "'></select> (level)&nbsp;&nbsp;&nbsp;Kills&nbsp;"
                    + "<input type='number' id='kills" + index + "' value='6' maxlength='6' style='width: 3em;' min='0' max='10'>";

                var adrenalinesel = document.getElementById("adrenaline" + index);
                opt = document.createElement("option");
                adrenalinesel.add(opt);
                opt.text = "None";
                opt.value = "0";

                for (var i = 1; i < 6; i++) {
                    opt = document.createElement("option");
                    adrenalinesel.add(opt);
                    opt.text = "" + i;
                    opt.value = "" + (30 + (i * 6));
                }
                adrenalinesel.selectedIndex = 0;
                adrenalinesel.onchange = function() {
                    recalculate(tbl, index, type);
                };

                document.getElementById("kills" + index ).oninput = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Weapon-specific boost" + info("weaponperk");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<select id='boost" + index + "'></select> %"

                var boost = document.getElementById("boost" + index);
                opt = document.createElement("option");
                boost.add(opt);
                opt.text = "None";
                opt.value = "0";

                for (var i = 10; i < 61; i += 5) {
                    opt = document.createElement("option");
                    boost.add(opt);
                    opt.text = "" + i;
                    opt.value = "" + i;
                }
                boost.selectedIndex = 0;
                boost.onchange = function() {
                    recalculate(tbl, index, type);
                };

                // ------------------------------------------------

                if (type === "Melee") {
                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Incisor" + info("incisor");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='incisor" + index + "'></select> (level)"

                    var incisor = document.getElementById("incisor" + index);
                    opt = document.createElement("option");
                    incisor.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    for (var i = 1; i < 4; i++) {
                        opt = document.createElement("option");
                        incisor.add(opt);
                        opt.text = "" + i;
                        opt.value = "" + (i * 25);
                    }
                    incisor.selectedIndex = 0;
                    incisor.onchange = function() {
                        recalculate(tbl, index, type);
                    };

                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Martial Artist" + info("martialartist");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='martialartist" + index + "'></select> (level)"

                    var martialartist = document.getElementById("martialartist" + index);
                    opt = document.createElement("option");
                    martialartist.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    for (var i = 1; i < 4; i++) {
                        opt = document.createElement("option");
                        martialartist.add(opt);
                        opt.text = "" + i;
                        opt.value = "" + (i * 10);
                    }
                    martialartist.selectedIndex = 0;
                    martialartist.onchange = function() {
                        recalculate(tbl, index, type);
                    };

                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Ninja" + info("ninja");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='ninja" + index + "'></select> (level)"

                    var ninja = document.getElementById("ninja" + index);
                    opt = document.createElement("option");
                    ninja.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    opt = document.createElement("option");
                        ninja.add(opt);
                        opt.text = "1";
                        opt.value = "30";
                    opt = document.createElement("option");
                        ninja.add(opt);
                        opt.text = "2";
                        opt.value = "60";
                    opt = document.createElement("option");
                        ninja.add(opt);
                        opt.text = "3";
                        opt.value = "100";

                    ninja.selectedIndex = 0;
                    ninja.onchange = function() {
                        recalculate(tbl, index, type);
                    };
                }

                if (type === "Ranged") {

                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Demolition Expert" + info("demolitionexpert");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='demolition" + index + "'></select> (level)"

                    var demolition = document.getElementById("demolition" + index);
                    opt = document.createElement("option");
                    demolition.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    for (var i = 1; i < 6; i++) {
                        opt = document.createElement("option");
                        demolition.add(opt);
                        opt.text = "" + i;
                        opt.value = "" + (20 + (i - 1) * 10);
                    }
                    // pre nerf available options
                    opt = document.createElement("option");
                    demolition.add(opt);
                    opt.text = "4 (pre nerf)";
                    opt.value = "80";
                    opt = document.createElement("option");
                    demolition.add(opt);
                    opt.text = "5 (pre nerf)";
                    opt.value = "100";

                    demolition.selectedIndex = 0;
                    demolition.onchange = function() {
                        recalculate(tbl, index, type);
                    };

                    if (weap.category === "Rifle") {
                        row = tbl.insertRow(tbl.rows.length);
                        cell1 = row.insertCell(0);
                        cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Tank killer" + info("tankkiller");
                        cell2 = row.insertCell(1);
                        cell2.innerHTML = "<select id='tankkiller" + index + "'></select> (level)"

                        var tankkiller = document.getElementById("tankkiller" + index);
                        opt = document.createElement("option");
                        tankkiller.add(opt);
                        opt.text = "None";
                        opt.value = "0";

                        for (var i = 1; i < 4; i++) {
                            opt = document.createElement("option");
                            tankkiller.add(opt);
                            opt.text = "" + i;
                            opt.value = "" + (i * 12);
                        }
                        tankkiller.selectedIndex = 0;
                        tankkiller.onchange = function() {
                            recalculate(tbl, index, type);
                        };
                    }
                    if (weap.category == "Heavy") {
                        row = tbl.insertRow(tbl.rows.length);
                        cell1 = row.insertCell(0);
                        cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Stabilized" + info("stabilized");
                        cell2 = row.insertCell(1);
                        cell2.innerHTML = "<select id='stabilized" + index + "'></select> (level)"

                        var stabilized = document.getElementById("stabilized" + index);
                        opt = document.createElement("option");
                        stabilized.add(opt);
                        opt.text = "None";
                        opt.value = "0";

                        for (var i = 1; i < 4; i++) {
                            opt = document.createElement("option");
                            stabilized.add(opt);
                            opt.text = "" + i;
                            opt.value = "" + (i * 15);
                        }
                        stabilized.selectedIndex = 0;
                        stabilized.onchange = function() {
                            recalculate(tbl, index, type);
                        };
                    }

                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Covert operative" + info("covertoperative");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='covertop" + index + "'></select> (level)"

                    var covertop = document.getElementById("covertop" + index);
                    opt = document.createElement("option");
                    covertop.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    opt = document.createElement("option");
                    covertop.add(opt);
                    opt.text = "1";
                    opt.value = "" + 15;

                    opt = document.createElement("option");
                    covertop.add(opt);
                    opt.text = "2";
                    opt.value = "" + 30;
                    
                    opt = document.createElement("option");
                    covertop.add(opt);
                    opt.text = "3";
                    opt.value = "" + 50;

                    covertop.selectedIndex = 0;
                    covertop.onchange = function() {
                        recalculate(tbl, index, type);
                    };
                    
                }

                row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Exterminator" + info("exterminator");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='exterminator" + index + "'></select> (level)"

                    var exterminator = document.getElementById("exterminator" + index);
                    opt = document.createElement("option");
                    exterminator.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    for (var i = 1; i < 4; i++) {
                        opt = document.createElement("option");
                        exterminator.add(opt);
                        opt.text = "" + i;
                        opt.value = "" + (25 * i);
                    }
                    exterminator.selectedIndex = 0;
                    exterminator.onchange = function() {
                        recalculate(tbl, index, type);
                    };

                row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Glow sight" + info("glowsight");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='glowsight" + index + "'></select> (level)"

                    var glowsight = document.getElementById("glowsight" + index);
                    opt = document.createElement("option");
                    glowsight.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    for (var i = 1; i < 4; i++) {
                        opt = document.createElement("option");
                        glowsight.add(opt);
                        opt.text = "" + i;
                        opt.value = "" + (20 * i);
                    }
                    glowsight.selectedIndex = 0;
                    glowsight.onchange = function() {
                        recalculate(tbl, index, type);
                    };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Nerd Rage" + info("nerdrage");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<select id='nerdrage" + index + "'></select> (level)"

                var nerdragesel = document.getElementById("nerdrage" + index);
                opt = document.createElement("option");
                nerdragesel.add(opt);
                opt.text = "None";
                opt.value = "0";

                for (var i = 1; i < 4; i++) {
                    opt = document.createElement("option");
                    nerdragesel.add(opt);
                    opt.text = "" + i;
                    opt.value = "" + (5 + i * 5);
                }
                nerdragesel.selectedIndex = 0;
                nerdragesel.onchange = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Revenant" + info("revenant");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<select id='revenant" + index + "'></select> (level)"
                
                var revenantsel = document.getElementById("revenant" + index);
                opt = document.createElement("option");
                revenantsel.add(opt);
                opt.text = "None";
                opt.value = "0";

                for (var i = 1; i < 3; i++) {
                    opt = document.createElement("option");
                    revenantsel.add(opt);
                    opt.text = "" + i;
                    opt.value = "" + (i * 25);
                }
                revenantsel.selectedIndex = 0;
                revenantsel.onchange = function() {
                    recalculate(tbl, index, type);
                };

                if (weap.silencer) {
                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Mister Sandman" + info("sandman");
                    cell2 = row.insertCell(1);
                    cell2.innerHTML = "<select id='sandman" + index + "'></select> (level)"
                    var sandmansel = document.getElementById("sandman" + index);
                    opt = document.createElement("option");
                    sandmansel.add(opt);
                    opt.text = "None";
                    opt.value = "0";

                    for (var i = 1; i < 3; i++) {
                        opt = document.createElement("option");
                        sandmansel.add(opt);
                        opt.text = "" + i;
                        opt.value = "" + (i * 25);
                    }
                    sandmansel.selectedIndex = 0;
                    sandmansel.onchange = function() {
                        recalculate(tbl, index, type);
                    };
                }

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Strange in numbers" + info("strangeinnumbers");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='radio' id='strangeinnumbers" + index + "_yes' name='strangeinnumbers" + index + "' value='1'> Yes&nbsp;&nbsp;&nbsp;"
                    + "<input type='radio' id='strangeinnumbers" + index + "_no' name='strangeinnumbers" + index + "' value='0' checked='checked'> No";

                document.getElementById("strangeinnumbers" + index + "_yes").onchange = function() {
                    recalculate(tbl, index, type);
                };
                document.getElementById("strangeinnumbers" + index + "_no").onchange = function() {
                    recalculate(tbl, index, type);
                };
            }

            function createMutations(tbl, index, type) {
                var row = tbl.insertRow(tbl.rows.length);
                var cell1 = row.insertCell(0);
                cell1.innerText = "Mutations";
                var cell2 = row.insertCell(1);

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Adrenal reaction" + info("adrenalreaction");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='radio' id='adrenalreaction" + index + "_yes' name='adrenalreaction" + index + "' value='1'> Yes&nbsp;&nbsp;&nbsp;"
                    + "<input type='radio' id='adrenalreaction" + index + "_no' name='adrenalreaction" + index + "' value='0' checked='checked'> No";

                document.getElementById("adrenalreaction" + index + "_yes").onchange = function() {
                    recalculate(tbl, index, type);
                };
                document.getElementById("adrenalreaction" + index + "_no").onchange = function() {
                    recalculate(tbl, index, type);
                };

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Any other mutation" + info("mutation");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='radio' id='mutation" + index + "_yes' name='mutation" + index + "' value='1'> Yes&nbsp;&nbsp;&nbsp;"
                    + "<input type='radio' id='mutation" + index + "_no' name='mutation" + index + "' value='0' checked='checked'> No";

                document.getElementById("mutation" + index + "_yes").onchange = function() {
                    recalculate(tbl, index, type);
                };
                document.getElementById("mutation" + index + "_no").onchange = function() {
                    recalculate(tbl, index, type);
                };
            }

            function createOther(tbl, index, type) {
                var row = tbl.insertRow(tbl.rows.length);
                var cell1 = row.insertCell(0);
                cell1.innerText = "Other";
                var cell2 = row.insertCell(1);

                row = tbl.insertRow(tbl.rows.length);
                cell1 = row.insertCell(0);
                cell1.innerHTML = "&nbsp;&nbsp;&nbsp;&nbsp;Buffs/chems boost" + info("buff");
                cell2 = row.insertCell(1);
                cell2.innerHTML = "<input type='number' id='otherboost" + index + "' value='0' maxlength='6' style='width: 8em;' min='-1000' max='1000'> %";
                document.getElementById("otherboost" + index ).oninput = function() {
                    recalculate(tbl, index, type);
                };
            }

            function recalculate(tbl, index, type) {
                var cell2 = document.getElementById("totaldamage" + index);
                var cell4 = document.getElementById("totalarmorignore" + index);
                var cell6 = document.getElementById("totalspeed" + index);
                var cell8 = document.getElementById("totaldps" + index);

                if (cell2 == null) {
                    var row = tbl.insertRow(tbl.rows.length);

                    var cell1 = row.insertCell(0);
                    cell1.innerText = "Total damage";
                    cell1.style = "border-top: 1px solid black;";

                    cell2 = row.insertCell(1);
                    cell2.id = "totaldamage" + index;
                    cell2.style = "border-top: 1px solid black; font-weight: bold; font-size: 26px;";

                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerText = "Total armor ignore";
                    //cell1.style = "border-top: 1px solid black;";

                    cell4 = row.insertCell(1);
                    cell4.id = "totalarmorignore" + index;
                    cell4.style = "font-weight: bold; font-size: 26px;";

                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerText = "Speed (hits per second)";
                    //cell1.style = "border-top: 1px solid black;";

                    cell6 = row.insertCell(1);
                    cell6.id = "totalspeed" + index;
                    cell6.style = "font-weight: bold; font-size: 26px;";

                    row = tbl.insertRow(tbl.rows.length);
                    cell1 = row.insertCell(0);
                    cell1.innerText = "Total damage per second";
                    //cell1.style = "border-top: 1px solid black;";

                    cell8 = row.insertCell(1);
                    cell8.id = "totaldps" + index;
                    cell8.style = "font-weight: bold; font-size: 26px;";
                }

                cell2.innerText = "";
                cell4.innerText = "";
                cell6.innerText = "";
                cell8.innerText = "";

                var weapIdx = document.getElementById("weapon" + index).selectedIndex;
                if (weapIdx < 0) {
                    return;
                }
                var levelIdx = document.getElementById("level" + index).selectedIndex;
                if (levelIdx < 0) {
                    return;
                }

                var weap = allWeapons.get(type)[weapIdx];

                var baseDamage = weap.damage[levelIdx];
                var baseDamageEnergy = weap.damageEnergy !== undefined ? weap.damageEnergy[levelIdx] : 0;
                var baseDamageRadiation = weap.damageRadiation !== undefined ? weap.damageRadiation[levelIdx] : 0;

                var strengthFactor = 0.05;
                var strengthBoost = 1;
                var repairFactor = 1;
                var speed = 1;

                var totalDamageAdditive = [];
                var totalDamageMultiply = [];

                var totalDamageEnergyAdditive = [];
                var totalDamageEnergyMultiply = [];

                var totalDamageRadiationAdditive = [];
                var totalDamageRadiationMultiply = [];

                var totalArmorIgnoreArray = [];
                var totalSpeedMultiply = [];

                var effects = allEffects.get(type);

                if (weap.speed !== undefined) {
                    speed = weap.speed;
                }

                // adjust for melee strength
                // ~~~~~~~~~~~~~~~~~~~~~~~~~
                if (type === "Melee") {
                    var strength = document.getElementById("strength" + index);
                    if (strength != null) {
                        var v = parseFloat(strength.value);
                        strengthBoost += v * strengthFactor;
                    }

                    effects.forEach(function(effect, idx) {
                        var effectSel = document.getElementById("effs_" + index + "_" + idx);
                        if (effectSel != null && effectSel.selectedIndex > 0) {
                            var effInfo = effects[idx][effectSel.selectedIndex - 1];
                            if (effInfo.name === "Strength") {
                                strengthBoost += strengthFactor;
                            }
                        }
                    });
                    baseDamage *= strengthBoost * repairFactor;
                }

                // add damage types from mods
                weap.mods.forEach(function(mod, idx) {
                    var modTypeIdx = document.getElementById("mods_" + index + "_" + idx).selectedIndex;
                    
                    if (modTypeIdx >= 0) {
                        var modInfo = mod.options[modTypeIdx];
                        if (modInfo.addDamageBallisticLeveled !== undefined) {
                            baseDamage += modInfo.addDamageBallisticLeveled[levelIdx];
                        }
                        if (modInfo.addDamageEnergyLeveled !== undefined) {
                            baseDamageEnergy += modInfo.addDamageEnergyLeveled[levelIdx];
                        }
                        if (modInfo.addDamageEnergyPercentLeveled !== undefined) {
                            baseDamageEnergy += (1 + modInfo.addDamageEnergyPercentLeveled[levelIdx] / 100.0) * baseDamage;
                        }
                        if (modInfo.addDamageRadiationLeveled !== undefined) {
                            baseDamageRadiation += modInfo.addDamageRadiationLeveled[levelIdx];
                        }
                    }
                });

                // apply bloody mess, adrenaline and adrenal reaction
                // ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

                var additiveBoosts = 0;
                var additiveEnergyBoosts = 0;

                var bloodymess = document.getElementById("bloodymess" + index);
                if (bloodymess != null && bloodymess.selectedIndex > 0) {
                    additiveBoosts += baseDamage * parseFloat(valueOf(bloodymess)) / 100.0;
                    additiveEnergyBoosts += baseDamageEnergy * parseFloat(valueOf(bloodymess)) / 100.0;
                }

                var adrenaline = document.getElementById("adrenaline" + index);
                if (adrenaline != null && adrenaline.selectedIndex > 0) {
                    var kills = document.getElementById("kills" + index);
                    var v = Math.min(6, parseFloat(kills.value));
                    if (v > 0) {
                        additiveBoosts += baseDamage * parseFloat(valueOf(adrenaline) * v / 6.0) / 100.0;
                        additiveEnergyBoosts += baseDamageEnergy * parseFloat(valueOf(adrenaline) * v / 6.0) / 100.0;
                    }
                }

                if (document.getElementById("adrenalreaction" + index + "_yes").checked) {
                    var health = parseFloat(document.getElementById("playerhealth" + index).value);
                    if (health <= 90) {
                        var perc = 0;
                        var superVersion = document.getElementById("strangeinnumbers" + index + "_yes").checked;
                        if (health <= 20) {
                            perc = superVersion ? 63 : 50;
                        } else 
                        if (health <= 30) {
                            perc = superVersion ? 55 : 44;
                        } else 
                        if (health <= 40) {
                            perc = superVersion ? 48 : 38;
                        } else 
                        if (health <= 50) {
                            perc = superVersion ? 39 : 31;
                        } else 
                        if (health <= 60) {
                            perc = superVersion ? 31 : 25;
                        } else 
                        if (health <= 70) {
                            perc = superVersion ? 24 : 19;
                        } else 
                        if (health <= 80) {
                            perc = superVersion ? 16 : 13;
                        } else {
                            perc = superVersion ? 8 : 6;
                        }
                        
                        additiveBoosts += baseDamage * perc / 100.0;
                        additiveEnergyBoosts += baseDamageEnergy * perc / 100.0;
                    }
                }
                baseDamage += additiveBoosts;
                baseDamageEnergy += additiveEnergyBoosts;

                var isSilenced = false;

                var versusMultiplier = 0;

                // apply mod effects
                // ~~~~~~~~~~~~~~~~~
                weap.mods.forEach(function(mod, idx) {
                    var modTypeIdx = document.getElementById("mods_" + index + "_" + idx).selectedIndex;
                    
                    if (modTypeIdx >= 0) {
                        var modInfo = mod.options[modTypeIdx];

                        if (modInfo.damageMultPercent !== undefined) {
                            totalDamageAdditive.push((baseDamage * modInfo.damageMultPercent / 100.0));
                            totalDamageEnergyAdditive.push((baseDamageEnergy * modInfo.damageMultPercent / 100.0));
                        }

                        if (modInfo.ignoreDRPercent !== undefined) {
                            totalArmorIgnoreArray.push(modInfo.ignoreDRPercent);
                        }
                        if (modInfo.silencer !== undefined && modInfo.silencer) {
                            isSilenced = true;
                        }
                        if (modInfo.speedMultPercent !== undefined) {
                            totalSpeedMultiply.push(modInfo.speedMultPercent);
                        }
                        if (modInfo.versus !== undefined) {
                            var enemytypes = valueOf(document.getElementById("enemytype" + index)).split(",");

                            for (var i = 0; i < enemytypes.length; i++) {
                                if (modInfo.versus.indexOf(enemytypes[i]) >= 0) {
                                    if (modInfo.versusAddPercent !== undefined) {
                                        versusMultiplier += modInfo.versusAddPercent;
                                        break;
                                    } else 
                                    if (modInfo.versusMultPercent !== undefined) {
                                        totalDamageMultiply.push(modInfo.versusMultPercent);
                                        totalDamageEnergyMultiply.push(modInfo.versusMultPercent);
                                        break;
                                    }

                                }
                            }
                        }
                    }
                });

                // Apply unconditional effects
                // ~~~~~~~~~~~~~~~~~~~~~~~~~~~
                effects.forEach(function(effect, idx) {
                    var effectSel = document.getElementById("effs_" + index + "_" + idx);
                    if (effectSel != null && effectSel.selectedIndex > 0) {
                        var effInfo = effects[idx][effectSel.selectedIndex - 1];
                        
                        if (effInfo.damageMultPercent !== undefined) {
                            var perc = effInfo.damageMultPercent;
                            if (type === "Ranged") {
                                if (effInfo.name.includes("Explosive")) {
                                    var demolitionsel = document.getElementById("demolition" + index);
                                    if (demolitionsel.selectedIndex > 0) {
                                        perc *= 1 + parseFloat(valueOf(demolitionsel)) / 100.0
                                    }
                                }
                                if (effInfo.name === "Aiming") {
                                    if (!document.getElementById("aiming" + index + "_yes").checked) {
                                        perc = 0;
                                    }
                                }
                                if (effInfo.name.includes("Two shot")) {
                                    // two shot appears to ignore the receiver modification
                                    totalDamageAdditive.push(Math.floor(baseDamage * perc / 100.0));
                                    totalDamageEnergyAdditive.push(Math.floor(baseDamageEnergy * perc / 100.0));
                                    totalDamageRadiationAdditive.push(Math.floor(baseDamageRadiation * perc / 100.0));
                                    // do not add it as a flat boost
                                    perc = 0;
                                }
                            }
                            if (effInfo.name === "Nocturnal") {
                                if (!document.getElementById("nighttime" + index + "_yes").checked) {
                                    perc = 0;
                                }
                            }
                            if (effInfo.name === "Instigating") {
                                if (parseFloat(document.getElementById("enemyhealth" + index).value) < 100) {
                                    perc = 0;
                                }
                            }
                            if (effInfo.name === "Executioner's") {
                                if (parseFloat(document.getElementById("enemyhealth" + index).value) > 40) {
                                    perc = 0;
                                }
                            }
                            if (effInfo.name === "Bloodied") {
                                var health = parseFloat(document.getElementById("playerhealth" + index).value);
                                perc = Math.min(95, Math.floor((100 - health) / 5) * 5);
                            }
                            if (effInfo.name === "Mutant's") {
                                if (!hasMutation(index)) {
                                    perc = 0;
                                }
                            }
                            // totalDamageAdditive.push(baseDamage * (perc / 100.0))
                            // effect damage does consider mods
                            totalDamageMultiply.push(perc);
                            totalDamageEnergyMultiply.push(perc);
                            //totalDamageAdditive.push(Math.floor(baseDamage * (perc / 100.0)));
                        }
                        if (effInfo.name === "Furious") {
                            var furioushits = document.getElementById("furioushits" + index);
                            var perc = 5 * Math.min(9, parseFloat(furioushits.value));
                            totalDamageMultiply.push(perc);
                            totalDamageEnergyMultiply.push(perc);
                        }
                        if (effInfo.name === "Junkie's") {
                            var junkiescount = document.getElementById("junkiescount" + index);
                            var perc = 10 * Math.min(5, parseFloat(junkiescount.value));
                            totalDamageMultiply.push(perc);
                            totalDamageEnergyMultiply.push(perc);
                        }
                        // Versus enemy effect
                        if (effInfo.versus !== undefined) {
                            var enemytypes = valueOf(document.getElementById("enemytype" + index)).split(",");

                            for (var i = 0; i < enemytypes.length; i++) {
                                if (effInfo.versus.indexOf(enemytypes[i]) >= 0) {
                                    if (effInfo.versusAddPercent !== undefined) {
                                        versusMultiplier += effInfo.versusAddPercent;
                                        break;
                                    } else 
                                    if (effInfo.versusMultPercent !== undefined) {
                                        totalDamageMultiply.push(effInfo.versusMultPercent);
                                        totalDamageEnergyMultiply.push(effInfo.versusMultPercent);
                                        break;
                                    }
                                }
                            }
                        }

                        if (effInfo.ignoreDRPercent !== undefined) {
                            totalArmorIgnoreArray.push(effInfo.ignoreDRPercent);
                        }
                        if (effInfo.silencer !== undefined && effInfo.silencer) {
                            isSilenced = true;
                        }
                        if (effInfo.speedMultPercent !== undefined) {
                            totalSpeedMultiply.push(effInfo.speedMultPercent);
                        }
                    }
                });

                var tankkiller = document.getElementById("tankkiller" + index);
                if (tankkiller != null && tankkiller.selectedIndex > 0) {
                    totalArmorIgnoreArray.push(parseFloat(valueOf(tankkiller)));
                }

                var incisor = document.getElementById("incisor" + index);
                if (incisor != null && incisor.selectedIndex > 0) {
                    totalArmorIgnoreArray.push(parseFloat(valueOf(incisor)));
                }

                var martialartist = document.getElementById("martialartist" + index);
                if (martialartist != null && martialartist.selectedIndex > 0) {
                    totalSpeedMultiply.push(parseFloat(valueOf(martialartist)));
                }

                var stabilized = document.getElementById("stabilized" + index);
                if (stabilized != null && stabilized.selectedIndex > 0) {
                    totalArmorIgnoreArray.push(parseFloat(valueOf(stabilized)));
                }

                if (versusMultiplier > 0) {
                    totalDamageMultiply.push(versusMultiplier);
                    totalDamageEnergyMultiply.push(versusMultiplier);
                }

                var exterminator = document.getElementById("exterminator" + index);
                if (exterminator != null && exterminator.selectedIndex > 0) {
                    var enemytypes = valueOf(document.getElementById("enemytype" + index)).split(",");
                    if (enemytypes.indexOf("Bug") >= 0 || enemytypes.indexOf("Mirelurk") >= 0) {
                        totalArmorIgnoreArray.push(parseFloat(valueOf(exterminator)));
                    }
                }

                var glowsight = document.getElementById("glowsight" + index);
                if (glowsight != null && glowsight.selectedIndex > 0) {
                    var enemytypes = valueOf(document.getElementById("enemytype" + index)).split(",");
                    if (enemytypes.indexOf("Glowing") >= 0) {
                        totalDamageMultiply.push(parseFloat(valueOf(glowsight)));
                        totalDamageEnergyMultiply.push(parseFloat(valueOf(glowsight)));
                    }
                }

                var boost = document.getElementById("boost" + index);
                if (boost != null && boost.selectedIndex > 0) {
                    totalDamageMultiply.push(parseFloat(valueOf(boost)));
                    totalDamageEnergyMultiply.push(parseFloat(valueOf(boost)));
                }

                var nerdrage = document.getElementById("nerdrage" + index);
                if (nerdrage.selectedIndex > 0) {
                    var health = parseFloat(document.getElementById("playerhealth" + index).value);
                    if (health < 20) {
                        totalDamageMultiply.push(valueOf(nerdrage));
                        totalDamageEnergyMultiply.push(valueOf(nerdrage));
                    }
                }

                var otherboost = document.getElementById("otherboost" + index);
                if (otherboost != null) {
                    var v = parseFloat(otherboost.value);
                    if (v > 0 || v < 0) {
                        totalDamageMultiply.push(v);
                        totalDamageEnergyMultiply.push(v);
                    }
                }

                var demolitionsel = document.getElementById("demolition" + index);
                if (demolitionsel != null && demolitionsel.selectedIndex > 0 && weap.explosive) {
                    totalDamageMultiply.push(parseFloat(valueOf(demolitionsel)));
                }

                var revenantsel = document.getElementById("revenant" + index);
                if (revenantsel != null && revenantsel.selectedIndex > 0) {
                    totalDamageMultiply.push(parseFloat(valueOf(revenantsel)));
                    totalDamageEnergyMultiply.push(parseFloat(valueOf(revenantsel)));
                }

                if (document.getElementById("sneaking" + index + "_yes").checked) {
                    var mult = 100;

                    var ninja = document.getElementById("ninja" + index);
                    if (ninja != null && ninja.selectedIndex > 0) {
                        mult += parseFloat(valueOf(ninja));
                    }

                    var covertop = document.getElementById("covertop" + index);
                    if (covertop != null && covertop.selectedIndex > 0) {
                        mult += parseFloat(valueOf(covertop));
                    }
                    totalDamageMultiply.push(mult);
                    totalDamageEnergyMultiply.push(mult);
                }

                if (document.getElementById("nighttime" + index + "_yes").checked) {
                    var sandman = document.getElementById("sandman" + index);
                    if (sandman != null && sandman.selectedIndex > 0) {
                        if (isSilenced) {
                            totalDamageMultiply.push(parseFloat(valueOf(sandman)));
                            totalDamageEnergyMultiply.push(parseFloat(valueOf(sandman)));
                        }
                    }
                }

                var totalDamage = baseDamage;
                totalDamageAdditive.forEach(function(v) {
                    totalDamage += v;
                });
                totalDamageMultiply.forEach(function(v) {
                    totalDamage *= 1.0 + v / 100.0;
                });

                var totalDamageEnergy = baseDamageEnergy;
                totalDamageEnergyAdditive.forEach(function(v) {
                    totalDamageEnergy += v;
                });
                totalDamageEnergyMultiply.forEach(function(v) {
                    totalDamageEnergy *= 1.0 + v / 100.0;
                });
                var totalDamageRadiation = baseDamageRadiation;
                totalDamageRadiationAdditive.forEach(function(v) {
                    totalDamageRadiation += v;
                });
                totalDamageRadiationMultiply.forEach(function(v) {
                    totalDamageRadiation *= 1.0 + v / 100.0;
                });

                totalSpeedMultiply.forEach(function(v) {
                    speed *= 1.0 + v / 100.0;
                });

                // enemy immunities
                var enemyTypeSel = document.getElementById("enemytype" + index);
                if (enemyTypeSel.selectedIndex > 0) {
                    var enemyType = enemyCategories[enemyTypeSel.selectedIndex - 1];

                    var enemyEffect = enemyRadiationEffect.get(enemyType.name);
                    if (enemyEffect != null) {
                        totalDamageRadiation *= enemyEffect / 100.0;
                    }
                }


                var totalArmorIgnore = 0;
                if (totalArmorIgnoreArray.length != 0) {
                    totalArmorIgnore = 1.0;
                    totalArmorIgnoreArray.forEach(function(v) {
                        totalArmorIgnore *= (1.0 - v / 100.0);
                    });
                    totalArmorIgnore = Math.min(95, 100 * (1 - totalArmorIgnore));
                }

                cell2.innerHTML = "\u2316&nbsp;" + totalDamage.toFixed(2) 
                    + "&nbsp;&nbsp;&nbsp;\u21AF&nbsp;" + totalDamageEnergy.toFixed(2) 
                    + "&nbsp;&nbsp;&nbsp;\u2622&nbsp;" + totalDamageRadiation.toFixed(2);
                cell4.innerText = totalArmorIgnore.toFixed(2) + " %";
                cell6.innerText = speed.toFixed(2);
                cell8.innerHTML = "\u2316&nbsp;" + (totalDamage * speed).toFixed(2) 
                    + "&nbsp;&nbsp;&nbsp;\u21AF&nbsp;" + (totalDamageEnergy * speed).toFixed(2) 
                    + "&nbsp;&nbsp;&nbsp;\u2622&nbsp;" + (totalDamageRadiation * speed).toFixed(2);

                damages[index] = totalDamage;
                damagesEnergy[index] = totalDamageEnergy;
                damagesRadiation[index] = totalDamageRadiation;
                ignores[index] = totalArmorIgnore;
                speeds[index] = speed;

                recalculateDiff();
            }

            function hasMutation(index) {
                var adrenalreaction = document.getElementById("adrenalreaction" + index + "_yes").checked;
                var anymutation = document.getElementById("mutation" + index + "_yes").checked;
                return adrenalreaction || anymutation;
            }



            function recalculateDiff() {
                var tbl = document.getElementById("table3");
                for (var i = tbl.rows.length - 1; i > 1; i--) {
                    tbl.deleteRow(i);
                }

                var speedFactorLeft = 1;
                var speedFactorRight = 1;

                if (document.getElementById("dpsmode").checked) {
                    speedFactorLeft = speeds[1]; 
                    speedFactorRight = speeds[2]; 
                }

                var evenOdd = false;
                var lastDr = null;
                var aaEnergy = true;

                enemyResistances.forEach(function(res) {
                    var row = tbl.insertRow(tbl.rows.length);

                    if (lastDr == null || lastDr != res.dr) {
                        evenOdd = !evenOdd;
                        lastDr = res.dr
                    }
                    if (evenOdd) {
                        row.style.backgroundColor = "#C0FFC0";
                    }

                    var dr = res.dr;
                    var er = res.er;
                    var leftDr = dr * (1 - Math.min(0.95, (ignores[1] / 100.0)));
                    var leftEr = aaEnergy ? er * (1 - Math.min(0.95, (ignores[1] / 100.0))) : er;
                    
                    var leftDmg = damageFormula(damages[1], leftDr) * speedFactorLeft;
                    var leftDmgEnergy = damageFormula(damagesEnergy[1], leftEr) * speedFactorLeft;
                    var leftDmgRadiation = damageFormula(damagesRadiation[1], res.rr) * speedFactorLeft;

                    var rightDr = dr * (1 - Math.min(0.95, (ignores[2] / 100.0)));
                    var rightEr = aaEnergy ? er * (1 - Math.min(0.95, (ignores[2] / 100.0))) : er;
                    var rightDmg = damageFormula(damages[2], rightDr) * speedFactorRight;
                    var rightDmgEnergy = damageFormula(damagesEnergy[2], rightEr) * speedFactorRight;
                    var rightDmgRadiation = damageFormula(damagesRadiation[2], res.rr) * speedFactorRight;

                    var cidx = 0;

                    var cell = row.insertCell(cidx++);
                    cell.innerText = "" + dr;
                    cell.style = "border: 1px solid black; text-align: right;";

                    cell = row.insertCell(cidx++);
                    cell.innerText = "" + res.er;
                    cell.style = "border: 1px solid black; text-align: right;";

                    cell = row.insertCell(cidx++);
                    cell.innerText = "" + res.rr;
                    cell.style = "border: 1px solid black; text-align: right;";

                    if (damages[1] > 0 || damagesEnergy[1] > 0 || damagesRadiation[1] > 0) {
                        cell = row.insertCell(cidx++);
                        cell.innerText = leftDr.toFixed(1);
                        cell.style = "border: 1px solid black; text-align: right;";

                        cell = row.insertCell(cidx++);
                        cell.innerText = leftEr.toFixed(1);
                        cell.style = "border: 1px solid black; text-align: right;";

                        cell = row.insertCell(cidx++);
                        cell.innerText = (leftDmg + leftDmgEnergy + leftDmgRadiation).toFixed(2);
                        cell.title = "\u2316 " + leftDmg.toFixed(2) 
                            + "    \u21AF " + leftDmgEnergy.toFixed(2) 
                            + "    \u2622 " + leftDmgRadiation.toFixed(2);
                        cell.style = "border: 1px solid black; text-align: right;";
                    } else {
                        cell = row.insertCell(cidx++);
                        cell.style = "border: 1px solid black; text-align: right;";
                        cell = row.insertCell(cidx++);
                        cell.style = "border: 1px solid black; text-align: right;";
                        cell = row.insertCell(cidx++);
                        cell.style = "border: 1px solid black; text-align: right;";
                    }

                    if ((damages[1] > 0 || damagesEnergy[1] > 0 || damagesRadiation[1] > 0) 
                            && (damages[2] > 0 || damagesEnergy[2] > 0 || damagesRadiation[2] > 0) > 0) {
                        cell = row.insertCell(cidx++);
                        cell.innerText = (100 - ((rightDmg + rightDmgEnergy + rightDmgRadiation) / (leftDmg + leftDmgEnergy + leftDmgRadiation)) * 100).toFixed(2) + " %";
                        cell.style = "border: 1px solid black; text-align: right;";
                    } else {
                        cell = row.insertCell(cidx++);
                        cell.style = "border: 1px solid black; text-align: right;";
                    }

                    if (damages[2] > 0 || damagesEnergy[2] > 0 || damagesRadiation[2] > 0) {
                        cell = row.insertCell(cidx++);
                        cell.innerText = rightDr.toFixed(1);
                        cell.style = "border: 1px solid black; text-align: right;";

                        cell = row.insertCell(cidx++);
                        cell.innerText = rightEr.toFixed(1);
                        cell.style = "border: 1px solid black; text-align: right;";

                        cell = row.insertCell(cidx++);
                        cell.innerText = (rightDmg + rightDmgEnergy + rightDmgRadiation).toFixed(2);
                        cell.title = "\u2316 " + rightDmg.toFixed(2) 
                            + "    \u21AF " + rightDmgEnergy.toFixed(2) 
                            + "    \u2622 " + rightDmgRadiation.toFixed(2);
                        cell.style = "border: 1px solid black; text-align: right;";
                    } else {
                        cell = row.insertCell(cidx++);
                        cell.style= "border: 1px solid black; text-align: right;";
                        cell = row.insertCell(cidx++);
                        cell.style= "border: 1px solid black; text-align: right;";
                        cell = row.insertCell(cidx++);
                        cell.style = "border: 1px solid black; text-align: right;";
                    }

                    if ((damages[1] > 0 || damagesEnergy[1] > 0 || damagesRadiation[1] > 0) 
                            && (damages[2] > 0 || damagesEnergy[2] > 0 || damagesRadiation[2] > 0) > 0) {
                        cell = row.insertCell(cidx++);
                        cell.innerText = (100 - ((leftDmg + leftDmgEnergy + leftDmgRadiation) / (rightDmg + rightDmgEnergy + rightDmgRadiation)) * 100).toFixed(2) + " %";
                        cell.style = "border: 1px solid black; text-align: right;";
                    } else {
                        cell = row.insertCell(cidx++);
                        cell.style = "border: 1px solid black; text-align: right;";
                    }

                });
            }

            function damageFormula(damage, dr) {
                if (damage <= 0) {
                    return damage;
                }
                return damage * Math.min(0.99, 0.5 * Math.pow(damage / dr, 0.366));
            }

            function valueOf(select) {
                return select.options[select.selectedIndex].value;
            }

            document.getElementById("copyright").onclick = function() {
                copyPanels(1, 2);
            };
            document.getElementById("copyleft").onclick = function() {
                copyPanels(2, 1);
            };

            function copyPanels(fromIdx, toIdx) {
                var wtype = "";
                if (document.getElementById("wtMelee" + fromIdx).checked) {
                    document.getElementById("wtMelee" + toIdx).click();
                    wtype = "Melee";
                } else {
                    document.getElementById("wtRanged" + toIdx).click();
                    wtype = "Ranged";
                }
                var selOther = document.getElementById("weapon" + toIdx);
                selOther.selectedIndex = document.getElementById("weapon" + fromIdx).selectedIndex;
                selOther.dispatchEvent(new Event('change'));

                var srcTable = document.getElementById("table" + fromIdx);
                var list = srcTable.querySelectorAll("input,select");
                list.forEach(function(node) {
                    var i = node.id.indexOf("" + fromIdx);
                    if (i >= 0) {
                        var newId = node.id.substring(0, i) + toIdx + node.id.substring(i + 1);
                        var nodeOther = document.getElementById(newId);

                        if (nodeOther.selectedIndex !== undefined) {
                            nodeOther.selectedIndex = node.selectedIndex;
                        }
                        if (nodeOther.checked !== undefined) {
                            nodeOther.checked = node.checked;
                        }
                        if (nodeOther.value !== undefined) {
                            nodeOther.value = node.value;
                        }
                    }
                });

                recalculate(document.getElementById("table" + toIdx), toIdx, wtype);
            }
        </script>
    </body>
</html>